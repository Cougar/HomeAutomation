MP2COD 4.02, COFF to COD File Converter
Copyright (c) 2006 Microchip Technology Inc.
Listing File Generated: Wed Jan 31 14:02:06 2007


Address  Value    Disassembly              Source                                                                           File
-------  -------  -----------------------  -------------------------------------------------------------------------------  -----
                                           /*********************************************************************           F:\MCP\projects\CAN\canBase\Source\CAN.c
                                            *                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                            *                  CAN module                                                   F:\MCP\projects\CAN\canBase\Source\CAN.c
                                            *                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                            *********************************************************************           F:\MCP\projects\CAN\canBase\Source\CAN.c
                                            * FileName:        $HeadURL: http://svn.arune.se/svn/HomeAutomation/trunk/EmbeddedSoftware/PIC/canBase/Source/CAN.c $ F:\MCP\projects\CAN\canBase\Source\CAN.c
                                            * Last changed:	$LastChangedDate: 2007-01-28 14:58:11 +0100 (s√∂, 28 jan 2007) $ F:\MCP\projects\CAN\canBase\Source\CAN.c
                                            * By:				$LastChangedBy: johboh $                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                            * Revision:		$Revision: 260 $                                                   F:\MCP\projects\CAN\canBase\Source\CAN.c
                                            ********************************************************************/           F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           #include <CANdefs.h>                                                             F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           #include <stackTasks.h>                                                          F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           #include <CAN.h>                                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           #include <EEaccess.h>                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           #include <funcdefs.h>                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           #include <Tick.h>                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           TICK heartbeat;                                                                  F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           static int MY_ID = DEFAULT_ID;                                                   F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           static BYTE MY_NID = DEFAULT_NID;                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           static CAN_MESSAGE outCm;                                                        F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           static void canGetPacket(void);                                                  F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           /*                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Function: canInit                                                              F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Input:	none                                                                    F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Output: none                                                                   F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Pre-conditions: none                                                           F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Affects: Changes can registers.                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           */                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           void canInit()                                                                   F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           {                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
00105c   0e80     MOVLW     0x80           	CANCON = 0x80; //request config mode                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
00105e   6e6f     MOVWF     0x6f,0x0                                                                                        
001060   0ee0     MOVLW     0xe0           	while ((CANSTAT & 0xE0) != 0x80 ); //wait for config mode request               F:\MCP\projects\CAN\canBase\Source\CAN.c
001062   146e     ANDWF     0x6e,0x0,0x0                                                                                    
001064   0880     SUBLW     0x80                                                                                            
001066   e001     BZ        0x106a                                                                                          
001068   d7fb     BRA       0x1060                                                                                          
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// BAUD AND TQS                                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// 500Khz@40Mhz (new by the book)                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
00106a   0e04     MOVLW     0x4            	BRGCON1 = 0x04;                                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
00106c   6e70     MOVWF     0x70,0x0                                                                                        
00106e   0ed1     MOVLW     0xd1           	BRGCON2 = 0xD1;                                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
001070   6e71     MOVWF     0x71,0x0                                                                                        
001072   0e81     MOVLW     0x81           	BRGCON3 = 0x81;                                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
001074   6e72     MOVWF     0x72,0x0                                                                                        
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON1=0;                                                                    F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// Sync_Seq = 2 x TQ = 1                                                        F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON1bits.SJW1=0;                                                           F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON1bits.SJW0=1;                                                           F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// Setting BRP.                                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON1=BRGCON1|CAN_BRP;                                                      F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// Maximum PHEG1                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON2bits.SEG2PHTS = 1;                                                     F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// Phase_Seg1 = 2 x TQ = 1                                                      F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON2bits.SEG1PH2 = 0;                                                      F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON2bits.SEG1PH1 = 0;                                                      F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON2bits.SEG1PH0 = 1;                                                      F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// Prop_Seq = 2 x TQ = 1                                                        F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON2bits.PRSEG2 = 0;                                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON2bits.PRSEG1 = 0;                                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON2bits.PRSEG0 = 1;                                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//  Enableing bus wake-up                                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON3bits.WAKDIS = 0;                                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// Dont use filter when wakeup                                                  F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON3bits.WAKFIL = 0;                                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// Phase_Seg2 = 2 x TQ = 1                                                      F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON3bits.SEG2PH2 = 0;                                                      F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON3bits.SEG2PH1 = 0;                                                      F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//BRGCON3bits.SEG2PH0 = 1;                                                      F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
001076   6a77     CLRF      0x77,0x0       	ECANCON=0;                                                                      F:\MCP\projects\CAN\canBase\Source\CAN.c
001078   8e77     BSF       0x77,0x7,0x0   	ECANCONbits.MDSEL1 = 1; // 0  For mode 1                                        F:\MCP\projects\CAN\canBase\Source\CAN.c
00107a   9c77     BCF       0x77,0x6,0x0   	ECANCONbits.MDSEL0 = 0; // 1  For mode 1                                        F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// FILTERS AND MASKS                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
00107c   8c60     BSF       0x60,0x6,0x0   	RXB0CONbits.RXM1=1;                                                             F:\MCP\projects\CAN\canBase\Source\CAN.c
00107e   9a60     BCF       0x60,0x5,0x0   	RXB0CONbits.RXM0=0;                                                             F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// INTERRUPTS                                                                   F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// Diable transmit interrupt                                                    F:\MCP\projects\CAN\canBase\Source\CAN.c
001080   010d     MOVLB     0xd            	TXBIE = 0;                                                                      F:\MCP\projects\CAN\canBase\Source\CAN.c
001082   6bfc     CLRF      0xfc,0x1                                                                                        
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//rx any interrupt                                                              F:\MCP\projects\CAN\canBase\Source\CAN.c
001084   6aa4     CLRF      0xa4,0x0       	PIR3 = 0;                                                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
001086   0e03     MOVLW     0x3            	PIE3 = 0b00000011;                                                              F:\MCP\projects\CAN\canBase\Source\CAN.c
001088   6ea3     MOVWF     0xa3,0x0                                                                                        
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// High interrupt                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
00108a   6ea5     MOVWF     0xa5,0x0       	IPR3 =0b00000011;                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// Programmable buffers interrupt                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
00108c   69fa     SETF      0xfa,0x1       	BIE0  = 0xFF;	                                                                  F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	//loopback mode or not                                                          F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	#ifdef CAN_LOOPBACK_MODE                                                        F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		CANCON = 0x40;//request loopback mode                                          F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		while ((CANSTAT & 0xE0) != 0x40 );//wait for loopback mode                     F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	#else                                                                           F:\MCP\projects\CAN\canBase\Source\CAN.c
00108e   6a6f     CLRF      0x6f,0x0       		CANCON = 0x00;//request normal mode                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
001090   0ee0     MOVLW     0xe0           		while ((CANSTAT & 0xE0) != 0x00 );//wait for normal mode                       F:\MCP\projects\CAN\canBase\Source\CAN.c
001092   146e     ANDWF     0x6e,0x0,0x0                                                                                    
001094   e001     BZ        0x1098                                                                                          
001096   d7fc     BRA       0x1090                                                                                          
                                           	#endif                                                                          F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// Init ticker service                                                          F:\MCP\projects\CAN\canBase\Source\CAN.c
001098   ecc8     CALL      0x1f90,0x0     	tickInit();                                                                     F:\MCP\projects\CAN\canBase\Source\CAN.c
00109a   f00f                                                                                                               
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// Read ID and NID if exist.                                                    F:\MCP\projects\CAN\canBase\Source\CAN.c
00109c   0e00     MOVLW     0x0            	if (EERead(NODE_ID_EE)==NODE_HAS_ID)                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
00109e   6ee6     MOVWF     0xe6,0x0                                                                                        
0010a0   6ae6     CLRF      0xe6,0x0                                                                                        
0010a2   ec74     CALL      0x1ce8,0x0                                                                                      
0010a4   f00e                                                                                                               
0010a6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010a8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010aa   082a     SUBLW     0x2a                                                                                            
0010ac   e12b     BNZ       0x1104                                                                                          
                                           	{                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
0010ae   0e01     MOVLW     0x1            		MY_ID=(((WORD)EERead(NODE_ID_EE + 1))<<8)+EERead(NODE_ID_EE + 2);              F:\MCP\projects\CAN\canBase\Source\CAN.c
0010b0   6ee6     MOVWF     0xe6,0x0                                                                                        
0010b2   6ae6     CLRF      0xe6,0x0                                                                                        
0010b4   ec74     CALL      0x1ce8,0x0                                                                                      
0010b6   f00e                                                                                                               
0010b8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010ba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010bc   6e14     MOVWF     0x14,0x0                                                                                        
0010be   c014     MOVFF     0x14,0x15                                                                                       
0010c0   f015                                                                                                               
0010c2   6a14     CLRF      0x14,0x0                                                                                        
0010c4   c014     MOVFF     0x14,0xfe6                                                                                      
0010c6   ffe6                                                                                                               
0010c8   c015     MOVFF     0x15,0xfe6                                                                                      
0010ca   ffe6                                                                                                               
0010cc   0e02     MOVLW     0x2                                                                                             
0010ce   6ee6     MOVWF     0xe6,0x0                                                                                        
0010d0   6ae6     CLRF      0xe6,0x0                                                                                        
0010d2   ec74     CALL      0x1ce8,0x0                                                                                      
0010d4   f00e                                                                                                               
0010d6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010d8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010da   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010dc   cfe7     MOVFF     0xfe7,0x15                                                                                      
0010de   f015                                                                                                               
0010e0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010e2   cfe7     MOVFF     0xfe7,0x14                                                                                      
0010e4   f014                                                                                                               
0010e6   0100     MOVLB     0x0                                                                                             
0010e8   2414     ADDWF     0x14,0x0,0x0                                                                                    
0010ea   6f9a     MOVWF     0x9a,0x1                                                                                        
0010ec   0e00     MOVLW     0x0                                                                                             
0010ee   2015     ADDWFC    0x15,0x0,0x0                                                                                    
0010f0   6f9b     MOVWF     0x9b,0x1                                                                                        
0010f2   0e03     MOVLW     0x3            		MY_NID=EERead(NODE_ID_EE + 3);                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
0010f4   6ee6     MOVWF     0xe6,0x0                                                                                        
0010f6   6ae6     CLRF      0xe6,0x0                                                                                        
0010f8   ec74     CALL      0x1ce8,0x0                                                                                      
0010fa   f00e                                                                                                               
0010fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010fe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001100   0100     MOVLB     0x0                                                                                             
001102   6f9c     MOVWF     0x9c,0x1                                                                                        
                                           	}                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	// Send user program startup heatbeat                                           F:\MCP\projects\CAN\canBase\Source\CAN.c
001104   0100     MOVLB     0x0            	outCm.funct 					= FUNCT_BOOTLOADER;                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
001106   6b64     CLRF      0x64,0x1                                                                                        
001108   0e08     MOVLW     0x8            	outCm.funcc 					= FUNCC_BOOT_HEARTBEAT;                                        F:\MCP\projects\CAN\canBase\Source\CAN.c
00110a   6f65     MOVWF     0x65,0x1                                                                                        
00110c   6b66     CLRF      0x66,0x1                                                                                        
00110e   0e01     MOVLW     0x1            	outCm.data_length 				= 1;                                                      F:\MCP\projects\CAN\canBase\Source\CAN.c
001110   6f6a     MOVWF     0x6a,0x1                                                                                        
001112   6f6b     MOVWF     0x6b,0x1       	outCm.data[BOOT_DATA_HEARTBEAT_INDEX] = HEARTBEAT_USER_STARTUP;                 F:\MCP\projects\CAN\canBase\Source\CAN.c
001114   0e02     MOVLW     0x2            	while(!canSendMessage(outCm,PRIO_HIGH));                                        F:\MCP\projects\CAN\canBase\Source\CAN.c
001116   6ee6     MOVWF     0xe6,0x0                                                                                        
001118   c064     MOVFF     0x64,0xfe6                                                                                      
00111a   ffe6                                                                                                               
00111c   c065     MOVFF     0x65,0xfe6                                                                                      
00111e   ffe6                                                                                                               
001120   c066     MOVFF     0x66,0xfe6                                                                                      
001122   ffe6                                                                                                               
001124   c067     MOVFF     0x67,0xfe6                                                                                      
001126   ffe6                                                                                                               
001128   c068     MOVFF     0x68,0xfe6                                                                                      
00112a   ffe6                                                                                                               
00112c   c069     MOVFF     0x69,0xfe6                                                                                      
00112e   ffe6                                                                                                               
001130   c06a     MOVFF     0x6a,0xfe6                                                                                      
001132   ffe6                                                                                                               
001134   c06b     MOVFF     0x6b,0xfe6                                                                                      
001136   ffe6                                                                                                               
001138   c06c     MOVFF     0x6c,0xfe6                                                                                      
00113a   ffe6                                                                                                               
00113c   c06d     MOVFF     0x6d,0xfe6                                                                                      
00113e   ffe6                                                                                                               
001140   c06e     MOVFF     0x6e,0xfe6                                                                                      
001142   ffe6                                                                                                               
001144   c06f     MOVFF     0x6f,0xfe6                                                                                      
001146   ffe6                                                                                                               
001148   c070     MOVFF     0x70,0xfe6                                                                                      
00114a   ffe6                                                                                                               
00114c   c071     MOVFF     0x71,0xfe6                                                                                      
00114e   ffe6                                                                                                               
001150   c072     MOVFF     0x72,0xfe6                                                                                      
001152   ffe6                                                                                                               
001154   d9f3     RCALL     0x153c                                                                                          
001156   6e14     MOVWF     0x14,0x0                                                                                        
001158   0e10     MOVLW     0x10                                                                                            
00115a   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
00115c   5014     MOVF      0x14,0x0,0x0                                                                                    
00115e   0900     IORLW     0x0                                                                                             
001160   e101     BNZ       0x1164                                                                                          
001162   d7d8     BRA       0x1114                                                                                          
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
001164   0012     RETURN    0x0            }                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           /*                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Function: canISR                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Input:	none                                                                    F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Output: none                                                                   F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Pre-conditions: a call to canInit()                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Affects: interrupt registers and receive data buffers                          F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Depends: ..                                                                    F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           */                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           void canISR()                                                                    F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           {                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
001166   50a4     MOVF      0xa4,0x0,0x0   	if (PIR3bits.RXBnIF || PIR3bits.RXB1IF || PIR3bits.RXB0IF)                      F:\MCP\projects\CAN\canBase\Source\CAN.c
001168   0b02     ANDLW     0x2                                                                                             
00116a   e106     BNZ       0x1178                                                                                          
00116c   50a4     MOVF      0xa4,0x0,0x0                                                                                    
00116e   0b02     ANDLW     0x2                                                                                             
001170   e103     BNZ       0x1178                                                                                          
001172   50a4     MOVF      0xa4,0x0,0x0                                                                                    
001174   0b01     ANDLW     0x1                                                                                             
001176   e016     BZ        0x11a4                                                                                          
                                           	{                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
001178   0e0f     MOVLW     0xf            		ECANCON=(ECANCON&0b00000)|(0b10000|(CANCON&0x0F));                             F:\MCP\projects\CAN\canBase\Source\CAN.c
00117a   146f     ANDWF     0x6f,0x0,0x0                                                                                    
00117c   0910     IORLW     0x10                                                                                            
00117e   6e14     MOVWF     0x14,0x0                                                                                        
001180   0e00     MOVLW     0x0                                                                                             
001182   1477     ANDWF     0x77,0x0,0x0                                                                                    
001184   1014     IORWF     0x14,0x0,0x0                                                                                    
001186   6e77     MOVWF     0x77,0x0                                                                                        
001188   be60     BTFSC     0x60,0x7,0x0   		if (RXB0CONbits.RXFUL) canGetPacket();                                         F:\MCP\projects\CAN\canBase\Source\CAN.c
00118a   d86a     RCALL     0x1260                                                                                          
                                           	                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
00118c   a2a4     BTFSS     0xa4,0x1,0x0   		if (PIR3bits.RXBnIF) {PIR3bits.RXBnIF = 0; return;}                            F:\MCP\projects\CAN\canBase\Source\CAN.c
00118e   d002     BRA       0x1194                                                                                          
001190   92a4     BCF       0xa4,0x1,0x0                                                                                    
001192   d065     BRA       0x125e                                                                                          
001194   a2a4     BTFSS     0xa4,0x1,0x0   		if (PIR3bits.RXB1IF) {PIR3bits.RXB1IF = 0; return;}                            F:\MCP\projects\CAN\canBase\Source\CAN.c
001196   d002     BRA       0x119c                                                                                          
001198   92a4     BCF       0xa4,0x1,0x0                                                                                    
00119a   d061     BRA       0x125e                                                                                          
00119c   a0a4     BTFSS     0xa4,0x0,0x0   		if (PIR3bits.RXB0IF) {PIR3bits.RXB0IF = 0; return;}                            F:\MCP\projects\CAN\canBase\Source\CAN.c
00119e   d002     BRA       0x11a4                                                                                          
0011a0   90a4     BCF       0xa4,0x0,0x0                                                                                    
0011a2   d05d     BRA       0x125e                                                                                          
                                           	}                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
0011a4   ecdc     CALL      0x1fb8,0x0     	tickUpdate();                                                                   F:\MCP\projects\CAN\canBase\Source\CAN.c
0011a6   f00f                                                                                                               
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
0011a8   ecd2     CALL      0x1fa4,0x0     	if ((tickGet()-heartbeat)>TICK_SECOND*5)                                        F:\MCP\projects\CAN\canBase\Source\CAN.c
0011aa   f00f                                                                                                               
0011ac   0100     MOVLB     0x0                                                                                             
0011ae   5160     MOVF      0x60,0x0,0x1                                                                                    
0011b0   5c06     SUBWF     0x6,0x0,0x0                                                                                     
0011b2   6e14     MOVWF     0x14,0x0                                                                                        
0011b4   0100     MOVLB     0x0                                                                                             
0011b6   5161     MOVF      0x61,0x0,0x1                                                                                    
0011b8   5807     SUBWFB    0x7,0x0,0x0                                                                                     
0011ba   6e15     MOVWF     0x15,0x0                                                                                        
0011bc   0100     MOVLB     0x0                                                                                             
0011be   5162     MOVF      0x62,0x0,0x1                                                                                    
0011c0   5808     SUBWFB    0x8,0x0,0x0                                                                                     
0011c2   6e16     MOVWF     0x16,0x0                                                                                        
0011c4   0100     MOVLB     0x0                                                                                             
0011c6   5163     MOVF      0x63,0x0,0x1                                                                                    
0011c8   5809     SUBWFB    0x9,0x0,0x0                                                                                     
0011ca   6e17     MOVWF     0x17,0x0                                                                                        
0011cc   80d8     BSF       0xd8,0x0,0x0                                                                                    
0011ce   0ef4     MOVLW     0xf4                                                                                            
0011d0   5414     SUBFWB    0x14,0x0,0x0                                                                                    
0011d2   0e01     MOVLW     0x1                                                                                             
0011d4   5415     SUBFWB    0x15,0x0,0x0                                                                                    
0011d6   0e00     MOVLW     0x0                                                                                             
0011d8   5416     SUBFWB    0x16,0x0,0x0                                                                                    
0011da   0e00     MOVLW     0x0                                                                                             
0011dc   5417     SUBFWB    0x17,0x0,0x0                                                                                    
0011de   e23e     BC        0x125c                                                                                          
                                           	{                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		// Send alive heartbeat                                                        F:\MCP\projects\CAN\canBase\Source\CAN.c
0011e0   0100     MOVLB     0x0            		outCm.funct 					= FUNCT_BOOTLOADER;                                           F:\MCP\projects\CAN\canBase\Source\CAN.c
0011e2   6b64     CLRF      0x64,0x1                                                                                        
0011e4   0e08     MOVLW     0x8            		outCm.funcc 					= FUNCC_BOOT_HEARTBEAT;                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
0011e6   0100     MOVLB     0x0                                                                                             
0011e8   6f65     MOVWF     0x65,0x1                                                                                        
0011ea   6b66     CLRF      0x66,0x1                                                                                        
0011ec   0100     MOVLB     0x0            		outCm.data_length 				= 1;                                                     F:\MCP\projects\CAN\canBase\Source\CAN.c
0011ee   0e01     MOVLW     0x1                                                                                             
0011f0   6f6a     MOVWF     0x6a,0x1                                                                                        
0011f2   0100     MOVLB     0x0            		outCm.data[BOOT_DATA_HEARTBEAT_INDEX] = HEARTBEAT_ALIVE;                       F:\MCP\projects\CAN\canBase\Source\CAN.c
0011f4   0e02     MOVLW     0x2                                                                                             
0011f6   6f6b     MOVWF     0x6b,0x1                                                                                        
0011f8   0e02     MOVLW     0x2            		while(!canSendMessage(outCm,PRIO_HIGH));                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
0011fa   6ee6     MOVWF     0xe6,0x0                                                                                        
0011fc   c064     MOVFF     0x64,0xfe6                                                                                      
0011fe   ffe6                                                                                                               
001200   c065     MOVFF     0x65,0xfe6                                                                                      
001202   ffe6                                                                                                               
001204   c066     MOVFF     0x66,0xfe6                                                                                      
001206   ffe6                                                                                                               
001208   c067     MOVFF     0x67,0xfe6                                                                                      
00120a   ffe6                                                                                                               
00120c   c068     MOVFF     0x68,0xfe6                                                                                      
00120e   ffe6                                                                                                               
001210   c069     MOVFF     0x69,0xfe6                                                                                      
001212   ffe6                                                                                                               
001214   c06a     MOVFF     0x6a,0xfe6                                                                                      
001216   ffe6                                                                                                               
001218   c06b     MOVFF     0x6b,0xfe6                                                                                      
00121a   ffe6                                                                                                               
00121c   c06c     MOVFF     0x6c,0xfe6                                                                                      
00121e   ffe6                                                                                                               
001220   c06d     MOVFF     0x6d,0xfe6                                                                                      
001222   ffe6                                                                                                               
001224   c06e     MOVFF     0x6e,0xfe6                                                                                      
001226   ffe6                                                                                                               
001228   c06f     MOVFF     0x6f,0xfe6                                                                                      
00122a   ffe6                                                                                                               
00122c   c070     MOVFF     0x70,0xfe6                                                                                      
00122e   ffe6                                                                                                               
001230   c071     MOVFF     0x71,0xfe6                                                                                      
001232   ffe6                                                                                                               
001234   c072     MOVFF     0x72,0xfe6                                                                                      
001236   ffe6                                                                                                               
001238   d981     RCALL     0x153c                                                                                          
00123a   6e14     MOVWF     0x14,0x0                                                                                        
00123c   0e10     MOVLW     0x10                                                                                            
00123e   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
001240   5014     MOVF      0x14,0x0,0x0                                                                                    
001242   0900     IORLW     0x0                                                                                             
001244   e101     BNZ       0x1248                                                                                          
001246   d7d8     BRA       0x11f8                                                                                          
                                           			                                                                              F:\MCP\projects\CAN\canBase\Source\CAN.c
001248   ecd2     CALL      0x1fa4,0x0     		heartbeat = tickGet();                                                         F:\MCP\projects\CAN\canBase\Source\CAN.c
00124a   f00f                                                                                                               
00124c   c006     MOVFF     0x6,0x60                                                                                        
00124e   f060                                                                                                               
001250   c007     MOVFF     0x7,0x61                                                                                        
001252   f061                                                                                                               
001254   c008     MOVFF     0x8,0x62                                                                                        
001256   f062                                                                                                               
001258   c009     MOVFF     0x9,0x63                                                                                        
00125a   f063                                                                                                               
                                           	}                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
00125c   0004     CLRWDT                   	ClrWdt();                                                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
00125e   0012     RETURN    0x0            }                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           /*                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Function: canGetPacket                                                         F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Input:	none                                                                    F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Output: none                                                                   F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Pre-conditions: a call to canISR and an packet is available and banked to RXB0 F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Affects: Calls canParse() function in main for parsing received packet.        F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           */                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
001260   cfd9     MOVFF     0xfd9,0xfe6    void canGetPacket()                                                              F:\MCP\projects\CAN\canBase\Source\CAN.c
001262   ffe6                                                                                                               
001264   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001266   ffd9                                                                                                               
001268   0e0f     MOVLW     0xf                                                                                             
00126a   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		CAN_MESSAGE cm;                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		//RXB0SIDH 28 27 26 25 24 23 22 21                                             F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                   //RXB0SIDL 20 19 18 xx xx xx 17 16                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                   //RXB0EIDH 15 14 13 12 11 10 09 08                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                   //RXB0EIDL 07 06 05 04 03 02 01 00                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		//funct xx xx xx xx 28 27 26 25                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		//funcc xx xx xx xx xx xx 24 23 22 21 20 19 18 17 16 15                        F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		//nid   xx xx 14 13 12 11 10 09                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		//sid   xx xx xx xx xx xx xx 08 07 06 05 04 03 02 01 00                        F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
00126c   0ef0     MOVLW     0xf0                  	cm.funct=((RXB0SIDH & 0xF0)>>4);                                         F:\MCP\projects\CAN\canBase\Source\CAN.c
00126e   1461     ANDWF     0x61,0x0,0x0                                                                                    
001270   38e8     SWAPF     0xe8,0x0,0x0                                                                                    
001272   0b0f     ANDLW     0xf                                                                                             
001274   6edf     MOVWF     0xdf,0x0                                                                                        
001276   0e0f     MOVLW     0xf                    cm.funcc=(((WORD)(RXB0SIDH & 0x0F))<<6)+(((WORD)(RXB0SIDL & 0xE0))>>2)+(((WORD)(RXB0SIDL & 0x03))<<1)+(((WORD)(RXB0EIDH & 0x80))>>7); F:\MCP\projects\CAN\canBase\Source\CAN.c
001278   1461     ANDWF     0x61,0x0,0x0                                                                                    
00127a   6e1a     MOVWF     0x1a,0x0                                                                                        
00127c   6a1b     CLRF      0x1b,0x0                                                                                        
00127e   0e06     MOVLW     0x6                                                                                             
001280   90d8     BCF       0xd8,0x0,0x0                                                                                    
001282   361a     RLCF      0x1a,0x1,0x0                                                                                    
001284   361b     RLCF      0x1b,0x1,0x0                                                                                    
001286   04e8     DECF      0xe8,0x0,0x0                                                                                    
001288   e1fb     BNZ       0x1280                                                                                          
00128a   0ee0     MOVLW     0xe0                                                                                            
00128c   1462     ANDWF     0x62,0x0,0x0                                                                                    
00128e   6e1c     MOVWF     0x1c,0x0                                                                                        
001290   6a1d     CLRF      0x1d,0x0                                                                                        
001292   90d8     BCF       0xd8,0x0,0x0                                                                                    
001294   321d     RRCF      0x1d,0x1,0x0                                                                                    
001296   321c     RRCF      0x1c,0x1,0x0                                                                                    
001298   90d8     BCF       0xd8,0x0,0x0                                                                                    
00129a   321d     RRCF      0x1d,0x1,0x0                                                                                    
00129c   321c     RRCF      0x1c,0x1,0x0                                                                                    
00129e   501a     MOVF      0x1a,0x0,0x0                                                                                    
0012a0   241c     ADDWF     0x1c,0x0,0x0                                                                                    
0012a2   6e18     MOVWF     0x18,0x0                                                                                        
0012a4   501b     MOVF      0x1b,0x0,0x0                                                                                    
0012a6   201d     ADDWFC    0x1d,0x0,0x0                                                                                    
0012a8   6e19     MOVWF     0x19,0x0                                                                                        
0012aa   0e03     MOVLW     0x3                                                                                             
0012ac   1462     ANDWF     0x62,0x0,0x0                                                                                    
0012ae   6e1e     MOVWF     0x1e,0x0                                                                                        
0012b0   6a1f     CLRF      0x1f,0x0                                                                                        
0012b2   90d8     BCF       0xd8,0x0,0x0                                                                                    
0012b4   361e     RLCF      0x1e,0x1,0x0                                                                                    
0012b6   361f     RLCF      0x1f,0x1,0x0                                                                                    
0012b8   5018     MOVF      0x18,0x0,0x0                                                                                    
0012ba   241e     ADDWF     0x1e,0x0,0x0                                                                                    
0012bc   6e16     MOVWF     0x16,0x0                                                                                        
0012be   5019     MOVF      0x19,0x0,0x0                                                                                    
0012c0   201f     ADDWFC    0x1f,0x0,0x0                                                                                    
0012c2   6e17     MOVWF     0x17,0x0                                                                                        
0012c4   0e80     MOVLW     0x80                                                                                            
0012c6   1463     ANDWF     0x63,0x0,0x0                                                                                    
0012c8   6e20     MOVWF     0x20,0x0                                                                                        
0012ca   6a21     CLRF      0x21,0x0                                                                                        
0012cc   0e07     MOVLW     0x7                                                                                             
0012ce   90d8     BCF       0xd8,0x0,0x0                                                                                    
0012d0   3221     RRCF      0x21,0x1,0x0                                                                                    
0012d2   3220     RRCF      0x20,0x1,0x0                                                                                    
0012d4   04e8     DECF      0xe8,0x0,0x0                                                                                    
0012d6   e1fb     BNZ       0x12ce                                                                                          
0012d8   5016     MOVF      0x16,0x0,0x0                                                                                    
0012da   2420     ADDWF     0x20,0x0,0x0                                                                                    
0012dc   6e14     MOVWF     0x14,0x0                                                                                        
0012de   5017     MOVF      0x17,0x0,0x0                                                                                    
0012e0   2021     ADDWFC    0x21,0x0,0x0                                                                                    
0012e2   6e15     MOVWF     0x15,0x0                                                                                        
0012e4   0e01     MOVLW     0x1                                                                                             
0012e6   c014     MOVFF     0x14,0xfdb                                                                                      
0012e8   ffdb                                                                                                               
0012ea   0e02     MOVLW     0x2                                                                                             
0012ec   c015     MOVFF     0x15,0xfdb                                                                                      
0012ee   ffdb                                                                                                               
0012f0   0e7e     MOVLW     0x7e                   cm.nid=((RXB0EIDH & 0x7E)>>1);                                           F:\MCP\projects\CAN\canBase\Source\CAN.c
0012f2   1463     ANDWF     0x63,0x0,0x0                                                                                    
0012f4   40e8     RRNCF     0xe8,0x0,0x0                                                                                    
0012f6   0b7f     ANDLW     0x7f                                                                                            
0012f8   6ee7     MOVWF     0xe7,0x0                                                                                        
0012fa   0e03     MOVLW     0x3                                                                                             
0012fc   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
0012fe   ffdb                                                                                                               
001300   0e01     MOVLW     0x1                    cm.sid=(((WORD)(RXB0EIDH & 0x01))<<8)+RXB0EIDL;                          F:\MCP\projects\CAN\canBase\Source\CAN.c
001302   1463     ANDWF     0x63,0x0,0x0                                                                                    
001304   6e16     MOVWF     0x16,0x0                                                                                        
001306   c016     MOVFF     0x16,0x17                                                                                       
001308   f017                                                                                                               
00130a   6a16     CLRF      0x16,0x0                                                                                        
00130c   5064     MOVF      0x64,0x0,0x0                                                                                    
00130e   0100     MOVLB     0x0                                                                                             
001310   2416     ADDWF     0x16,0x0,0x0                                                                                    
001312   6e14     MOVWF     0x14,0x0                                                                                        
001314   0e00     MOVLW     0x0                                                                                             
001316   2017     ADDWFC    0x17,0x0,0x0                                                                                    
001318   6e15     MOVWF     0x15,0x0                                                                                        
00131a   0e04     MOVLW     0x4                                                                                             
00131c   c014     MOVFF     0x14,0xfdb                                                                                      
00131e   ffdb                                                                                                               
001320   0e05     MOVLW     0x5                                                                                             
001322   c015     MOVFF     0x15,0xfdb                                                                                      
001324   ffdb                                                                                                               
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		// Data length                                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
001326   5065     MOVF      0x65,0x0,0x0   		cm.data_length=(RXB0DLCbits.DLC3<<3)+(RXB0DLCbits.DLC2<<2)+(RXB0DLCbits.DLC1<<1)+RXB0DLCbits.DLC0; F:\MCP\projects\CAN\canBase\Source\CAN.c
001328   0b01     ANDLW     0x1                                                                                             
00132a   6e16     MOVWF     0x16,0x0                                                                                        
00132c   5065     MOVF      0x65,0x0,0x0                                                                                    
00132e   0b02     ANDLW     0x2                                                                                             
001330   e001     BZ        0x1334                                                                                          
001332   0e01     MOVLW     0x1                                                                                             
001334   24e8     ADDWF     0xe8,0x0,0x0                                                                                    
001336   6e15     MOVWF     0x15,0x0                                                                                        
001338   5065     MOVF      0x65,0x0,0x0                                                                                    
00133a   0b04     ANDLW     0x4                                                                                             
00133c   e001     BZ        0x1340                                                                                          
00133e   0e01     MOVLW     0x1                                                                                             
001340   0d04     MULLW     0x4                                                                                             
001342   cff3     MOVFF     0xff3,0x14                                                                                      
001344   f014                                                                                                               
001346   5065     MOVF      0x65,0x0,0x0                                                                                    
001348   0b08     ANDLW     0x8                                                                                             
00134a   e001     BZ        0x134e                                                                                          
00134c   0e01     MOVLW     0x1                                                                                             
00134e   0d08     MULLW     0x8                                                                                             
001350   50f3     MOVF      0xf3,0x0,0x0                                                                                    
001352   2414     ADDWF     0x14,0x0,0x0                                                                                    
001354   2415     ADDWF     0x15,0x0,0x0                                                                                    
001356   2416     ADDWF     0x16,0x0,0x0                                                                                    
001358   6ee7     MOVWF     0xe7,0x0                                                                                        
00135a   0e06     MOVLW     0x6                                                                                             
00135c   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
00135e   ffdb                                                                                                               
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		// Data one bye one, for speed                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
001360   0e07     MOVLW     0x7            		cm.data[0]=RXB0D0;	cm.data[1]=RXB0D1;                                          F:\MCP\projects\CAN\canBase\Source\CAN.c
001362   cf66     MOVFF     0xf66,0xfdb                                                                                     
001364   ffdb                                                                                                               
001366   0e08     MOVLW     0x8                                                                                             
001368   cf67     MOVFF     0xf67,0xfdb                                                                                     
00136a   ffdb                                                                                                               
00136c   0e09     MOVLW     0x9            		cm.data[2]=RXB0D2; 	cm.data[3]=RXB0D3;                                         F:\MCP\projects\CAN\canBase\Source\CAN.c
00136e   cf68     MOVFF     0xf68,0xfdb                                                                                     
001370   ffdb                                                                                                               
001372   0e0a     MOVLW     0xa                                                                                             
001374   cf69     MOVFF     0xf69,0xfdb                                                                                     
001376   ffdb                                                                                                               
001378   0e0b     MOVLW     0xb            		cm.data[4]=RXB0D4; 	cm.data[5]=RXB0D5;                                         F:\MCP\projects\CAN\canBase\Source\CAN.c
00137a   cf6a     MOVFF     0xf6a,0xfdb                                                                                     
00137c   ffdb                                                                                                               
00137e   0e0c     MOVLW     0xc                                                                                             
001380   cf6b     MOVFF     0xf6b,0xfdb                                                                                     
001382   ffdb                                                                                                               
001384   0e0d     MOVLW     0xd            		cm.data[6]=RXB0D6; 	cm.data[7]=RXB0D7;                                         F:\MCP\projects\CAN\canBase\Source\CAN.c
001386   cf6c     MOVFF     0xf6c,0xfdb                                                                                     
001388   ffdb                                                                                                               
00138a   0e0e     MOVLW     0xe                                                                                             
00138c   cf6d     MOVFF     0xf6d,0xfdb                                                                                     
00138e   ffdb                                                                                                               
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		// Clear ful status                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
001390   9e60     BCF       0x60,0x7,0x0   		RXB0CONbits.RXFUL=0;                                                           F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		// Check if FUNCT_BOOTLOADER specific.                                         F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		// reset and id change                                                         F:\MCP\projects\CAN\canBase\Source\CAN.c
001392   50df     MOVF      0xdf,0x0,0x0   		if (cm.funct==FUNCT_BOOTLOADER)                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
001394   e001     BZ        0x1398                                                                                          
001396   d0a0     BRA       0x14d8                                                                                          
                                           		{                                                                              F:\MCP\projects\CAN\canBase\Source\CAN.c
001398   0e03     MOVLW     0x3            			if (cm.nid==MY_NID && ((((unsigned int)cm.data[BOOT_DATA_RID_HIGH_INDEX])<<8)+cm.data[BOOT_DATA_RID_LOW_INDEX])==MY_ID)  F:\MCP\projects\CAN\canBase\Source\CAN.c
00139a   50db     MOVF      0xdb,0x0,0x0                                                                                    
00139c   0100     MOVLB     0x0                                                                                             
00139e   5d9c     SUBWF     0x9c,0x0,0x1                                                                                    
0013a0   e001     BZ        0x13a4                                                                                          
0013a2   d09a     BRA       0x14d8                                                                                          
0013a4   0e0c     MOVLW     0xc                                                                                             
0013a6   cfdb     MOVFF     0xfdb,0x16                                                                                      
0013a8   f016                                                                                                               
0013aa   c016     MOVFF     0x16,0x17                                                                                       
0013ac   f017                                                                                                               
0013ae   6a16     CLRF      0x16,0x0                                                                                        
0013b0   0e0b     MOVLW     0xb                                                                                             
0013b2   50db     MOVF      0xdb,0x0,0x0                                                                                    
0013b4   0100     MOVLB     0x0                                                                                             
0013b6   2416     ADDWF     0x16,0x0,0x0                                                                                    
0013b8   6e14     MOVWF     0x14,0x0                                                                                        
0013ba   0e00     MOVLW     0x0                                                                                             
0013bc   2017     ADDWFC    0x17,0x0,0x0                                                                                    
0013be   6e15     MOVWF     0x15,0x0                                                                                        
0013c0   0100     MOVLB     0x0                                                                                             
0013c2   519a     MOVF      0x9a,0x0,0x1                                                                                    
0013c4   1814     XORWF     0x14,0x0,0x0                                                                                    
0013c6   e102     BNZ       0x13cc                                                                                          
0013c8   519b     MOVF      0x9b,0x0,0x1                                                                                    
0013ca   1815     XORWF     0x15,0x0,0x0                                                                                    
0013cc   e001     BZ        0x13d0                                                                                          
0013ce   d084     BRA       0x14d8                                                                                          
                                           			{                                                                             F:\MCP\projects\CAN\canBase\Source\CAN.c
0013d0   50d9     MOVF      0xd9,0x0,0x0   				if (cm.funcc==FUNCC_BOOT_INIT) Reset(); // Reset me.                         F:\MCP\projects\CAN\canBase\Source\CAN.c
0013d2   0f01     ADDLW     0x1                                                                                             
0013d4   6ee9     MOVWF     0xe9,0x0                                                                                        
0013d6   cfda     MOVFF     0xfda,0xfea                                                                                     
0013d8   ffea                                                                                                               
0013da   0e01     MOVLW     0x1                                                                                             
0013dc   18ee     XORWF     0xee,0x0,0x0                                                                                    
0013de   e101     BNZ       0x13e2                                                                                          
0013e0   50ed     MOVF      0xed,0x0,0x0                                                                                    
0013e2   e101     BNZ       0x13e6                                                                                          
0013e4   00ff     RESET                                                                                                     
0013e6   50d9     MOVF      0xd9,0x0,0x0   				if (cm.funcc==FUNCC_BOOT_SET_ID)                                             F:\MCP\projects\CAN\canBase\Source\CAN.c
0013e8   0f01     ADDLW     0x1                                                                                             
0013ea   6ee9     MOVWF     0xe9,0x0                                                                                        
0013ec   cfda     MOVFF     0xfda,0xfea                                                                                     
0013ee   ffea                                                                                                               
0013f0   0e06     MOVLW     0x6                                                                                             
0013f2   18ee     XORWF     0xee,0x0,0x0                                                                                    
0013f4   e101     BNZ       0x13f8                                                                                          
0013f6   50ed     MOVF      0xed,0x0,0x0                                                                                    
0013f8   e16f     BNZ       0x14d8                                                                                          
                                           				{                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           						// Change my ID and NID                                                    F:\MCP\projects\CAN\canBase\Source\CAN.c
0013fa   0e08     MOVLW     0x8            						MY_ID=(((WORD)cm.data[BOOT_DATA_NEW_ID_HIGH_INDEX])<<8)+cm.data[BOOT_DATA_NEW_ID_LOW_INDEX]; F:\MCP\projects\CAN\canBase\Source\CAN.c
0013fc   cfdb     MOVFF     0xfdb,0x14                                                                                      
0013fe   f014                                                                                                               
001400   c014     MOVFF     0x14,0x15                                                                                       
001402   f015                                                                                                               
001404   6a14     CLRF      0x14,0x0                                                                                        
001406   0e07     MOVLW     0x7                                                                                             
001408   50db     MOVF      0xdb,0x0,0x0                                                                                    
00140a   0100     MOVLB     0x0                                                                                             
00140c   2414     ADDWF     0x14,0x0,0x0                                                                                    
00140e   6f9a     MOVWF     0x9a,0x1                                                                                        
001410   0e00     MOVLW     0x0                                                                                             
001412   2015     ADDWFC    0x15,0x0,0x0                                                                                    
001414   6f9b     MOVWF     0x9b,0x1                                                                                        
001416   0e09     MOVLW     0x9            						MY_NID=cm.data[BOOT_DATA_NEW_NID_INDEX];                                   F:\MCP\projects\CAN\canBase\Source\CAN.c
001418   cfdb     MOVFF     0xfdb,0x9c                                                                                      
00141a   f09c                                                                                                               
00141c   0e08     MOVLW     0x8            						EEWrite(NODE_ID_EE+1,cm.data[BOOT_DATA_NEW_ID_HIGH_INDEX]);                F:\MCP\projects\CAN\canBase\Source\CAN.c
00141e   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
001420   ffe6                                                                                                               
001422   0e01     MOVLW     0x1                                                                                             
001424   6ee6     MOVWF     0xe6,0x0                                                                                        
001426   6ae6     CLRF      0xe6,0x0                                                                                        
001428   ec99     CALL      0x1d32,0x0                                                                                      
00142a   f00e                                                                                                               
00142c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00142e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001430   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001432   0e07     MOVLW     0x7            						EEWrite(NODE_ID_EE+2,cm.data[BOOT_DATA_NEW_ID_LOW_INDEX]);                 F:\MCP\projects\CAN\canBase\Source\CAN.c
001434   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
001436   ffe6                                                                                                               
001438   0e02     MOVLW     0x2                                                                                             
00143a   6ee6     MOVWF     0xe6,0x0                                                                                        
00143c   6ae6     CLRF      0xe6,0x0                                                                                        
00143e   ec99     CALL      0x1d32,0x0                                                                                      
001440   f00e                                                                                                               
001442   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001444   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001446   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001448   0e09     MOVLW     0x9            						EEWrite(NODE_ID_EE+3,cm.data[BOOT_DATA_NEW_NID_INDEX]);                    F:\MCP\projects\CAN\canBase\Source\CAN.c
00144a   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
00144c   ffe6                                                                                                               
00144e   0e03     MOVLW     0x3                                                                                             
001450   6ee6     MOVWF     0xe6,0x0                                                                                        
001452   6ae6     CLRF      0xe6,0x0                                                                                        
001454   ec99     CALL      0x1d32,0x0                                                                                      
001456   f00e                                                                                                               
001458   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00145a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00145c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00145e   0e2a     MOVLW     0x2a           						EEWrite(NODE_ID_EE,NODE_HAS_ID);                                           F:\MCP\projects\CAN\canBase\Source\CAN.c
001460   6ee6     MOVWF     0xe6,0x0                                                                                        
001462   0e00     MOVLW     0x0                                                                                             
001464   6ee6     MOVWF     0xe6,0x0                                                                                        
001466   6ae6     CLRF      0xe6,0x0                                                                                        
001468   ec99     CALL      0x1d32,0x0                                                                                      
00146a   f00e                                                                                                               
00146c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00146e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001470   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						// Send ack with new id.                                                   F:\MCP\projects\CAN\canBase\Source\CAN.c
001472   0100     MOVLB     0x0            						outCm.funct 					= FUNCT_BOOTLOADER;                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
001474   6b64     CLRF      0x64,0x1                                                                                        
001476   0e04     MOVLW     0x4            						outCm.funcc 					= FUNCC_BOOT_ACK;                                         F:\MCP\projects\CAN\canBase\Source\CAN.c
001478   0100     MOVLB     0x0                                                                                             
00147a   6f65     MOVWF     0x65,0x1                                                                                        
00147c   6b66     CLRF      0x66,0x1                                                                                        
00147e   0100     MOVLB     0x0            						outCm.data_length 				= 8;                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
001480   0e08     MOVLW     0x8                                                                                             
001482   6f6a     MOVWF     0x6a,0x1                                                                                        
001484   0100     MOVLB     0x0            						outCm.data[BOOT_DATA_ERR_INDEX]	= ACK_ERR_NO_ERROR;                        F:\MCP\projects\CAN\canBase\Source\CAN.c
001486   6b6f     CLRF      0x6f,0x1                                                                                        
001488   0e02     MOVLW     0x2            						while(!canSendMessage(outCm,PRIO_HIGH));                                   F:\MCP\projects\CAN\canBase\Source\CAN.c
00148a   6ee6     MOVWF     0xe6,0x0                                                                                        
00148c   c064     MOVFF     0x64,0xfe6                                                                                      
00148e   ffe6                                                                                                               
001490   c065     MOVFF     0x65,0xfe6                                                                                      
001492   ffe6                                                                                                               
001494   c066     MOVFF     0x66,0xfe6                                                                                      
001496   ffe6                                                                                                               
001498   c067     MOVFF     0x67,0xfe6                                                                                      
00149a   ffe6                                                                                                               
00149c   c068     MOVFF     0x68,0xfe6                                                                                      
00149e   ffe6                                                                                                               
0014a0   c069     MOVFF     0x69,0xfe6                                                                                      
0014a2   ffe6                                                                                                               
0014a4   c06a     MOVFF     0x6a,0xfe6                                                                                      
0014a6   ffe6                                                                                                               
0014a8   c06b     MOVFF     0x6b,0xfe6                                                                                      
0014aa   ffe6                                                                                                               
0014ac   c06c     MOVFF     0x6c,0xfe6                                                                                      
0014ae   ffe6                                                                                                               
0014b0   c06d     MOVFF     0x6d,0xfe6                                                                                      
0014b2   ffe6                                                                                                               
0014b4   c06e     MOVFF     0x6e,0xfe6                                                                                      
0014b6   ffe6                                                                                                               
0014b8   c06f     MOVFF     0x6f,0xfe6                                                                                      
0014ba   ffe6                                                                                                               
0014bc   c070     MOVFF     0x70,0xfe6                                                                                      
0014be   ffe6                                                                                                               
0014c0   c071     MOVFF     0x71,0xfe6                                                                                      
0014c2   ffe6                                                                                                               
0014c4   c072     MOVFF     0x72,0xfe6                                                                                      
0014c6   ffe6                                                                                                               
0014c8   d839     RCALL     0x153c                                                                                          
0014ca   6e14     MOVWF     0x14,0x0                                                                                        
0014cc   0e10     MOVLW     0x10                                                                                            
0014ce   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0014d0   5014     MOVF      0x14,0x0,0x0                                                                                    
0014d2   0900     IORLW     0x0                                                                                             
0014d4   e101     BNZ       0x14d8                                                                                          
0014d6   d7d8     BRA       0x1488                                                                                          
                                           				}                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           			}                                                                             F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		}                                                                              F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		//Call main parser                                                             F:\MCP\projects\CAN\canBase\Source\CAN.c
0014d8   cfd9     MOVFF     0xfd9,0xfe9    		canParse(cm);                                                                  F:\MCP\projects\CAN\canBase\Source\CAN.c
0014da   ffe9                                                                                                               
0014dc   cfda     MOVFF     0xfda,0xfea                                                                                     
0014de   ffea                                                                                                               
0014e0   cfee     MOVFF     0xfee,0xfe6                                                                                     
0014e2   ffe6                                                                                                               
0014e4   cfee     MOVFF     0xfee,0xfe6                                                                                     
0014e6   ffe6                                                                                                               
0014e8   cfee     MOVFF     0xfee,0xfe6                                                                                     
0014ea   ffe6                                                                                                               
0014ec   cfee     MOVFF     0xfee,0xfe6                                                                                     
0014ee   ffe6                                                                                                               
0014f0   cfee     MOVFF     0xfee,0xfe6                                                                                     
0014f2   ffe6                                                                                                               
0014f4   cfee     MOVFF     0xfee,0xfe6                                                                                     
0014f6   ffe6                                                                                                               
0014f8   cfee     MOVFF     0xfee,0xfe6                                                                                     
0014fa   ffe6                                                                                                               
0014fc   cfee     MOVFF     0xfee,0xfe6                                                                                     
0014fe   ffe6                                                                                                               
001500   cfee     MOVFF     0xfee,0xfe6                                                                                     
001502   ffe6                                                                                                               
001504   cfee     MOVFF     0xfee,0xfe6                                                                                     
001506   ffe6                                                                                                               
001508   cfee     MOVFF     0xfee,0xfe6                                                                                     
00150a   ffe6                                                                                                               
00150c   cfee     MOVFF     0xfee,0xfe6                                                                                     
00150e   ffe6                                                                                                               
001510   cfee     MOVFF     0xfee,0xfe6                                                                                     
001512   ffe6                                                                                                               
001514   cfee     MOVFF     0xfee,0xfe6                                                                                     
001516   ffe6                                                                                                               
001518   cfee     MOVFF     0xfee,0xfe6                                                                                     
00151a   ffe6                                                                                                               
00151c   ec65     CALL      0x1cca,0x0                                                                                      
00151e   f00e                                                                                                               
001520   6e14     MOVWF     0x14,0x0                                                                                        
001522   0e0f     MOVLW     0xf                                                                                             
001524   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
001526   5014     MOVF      0x14,0x0,0x0                                                                                    
001528   0e0f     MOVLW     0xf            }                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
00152a   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00152c   e202     BC        0x1532                                                                                          
00152e   6ae1     CLRF      0xe1,0x0                                                                                        
001530   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001532   6ee1     MOVWF     0xe1,0x0                                                                                        
001534   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001536   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001538   ffd9                                                                                                               
00153a   0012     RETURN    0x0                                                                                             
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           /*                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Function: canSendMessage                                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Input:	CAN_MESSAGE to send                                                     F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Output: True if packet scheduled sucess, false otherwise.                      F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Pre-conditions: canInit                                                        F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Affects: ..                                                                    F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           *	Depends: ..                                                                    F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           */                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
00153c   cfd9     MOVFF     0xfd9,0xfe6    BOOL canSendMessage(CAN_MESSAGE cm,CAN_PRIORITY prio)                            F:\MCP\projects\CAN\canBase\Source\CAN.c
00153e   ffe6                                                                                                               
001540   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001542   ffd9                                                                                                               
                                           {                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           	                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
001544   010f     MOVLB     0xf            	if ( TXB0CONbits.TXREQ == 0 )  { ECANCON=(ECANCON&0b00000)|0b00011; }           F:\MCP\projects\CAN\canBase\Source\CAN.c
001546   b740     BTFSC     0x40,0x3,0x1                                                                                    
001548   d004     BRA       0x1552                                                                                          
00154a   0e00     MOVLW     0x0                                                                                             
00154c   1477     ANDWF     0x77,0x0,0x0                                                                                    
00154e   0903     IORLW     0x3                                                                                             
001550   6e77     MOVWF     0x77,0x0                                                                                        
001552   010f     MOVLB     0xf            	if ( TXB1CONbits.TXREQ == 0 )  { ECANCON=(ECANCON&0b00000)|0b00100; }           F:\MCP\projects\CAN\canBase\Source\CAN.c
001554   b730     BTFSC     0x30,0x3,0x1                                                                                    
001556   d004     BRA       0x1560                                                                                          
001558   0e00     MOVLW     0x0                                                                                             
00155a   1477     ANDWF     0x77,0x0,0x0                                                                                    
00155c   0904     IORLW     0x4                                                                                             
00155e   6e77     MOVWF     0x77,0x0                                                                                        
001560   010f     MOVLB     0xf            	if ( TXB2CONbits.TXREQ == 0 )  { ECANCON=(ECANCON&0b00000)|0b00101; }           F:\MCP\projects\CAN\canBase\Source\CAN.c
001562   b720     BTFSC     0x20,0x3,0x1                                                                                    
001564   d005     BRA       0x1570                                                                                          
001566   0e00     MOVLW     0x0                                                                                             
001568   1477     ANDWF     0x77,0x0,0x0                                                                                    
00156a   0905     IORLW     0x5                                                                                             
00156c   6e77     MOVWF     0x77,0x0                                                                                        
                                           	// None of the transmit buffers were empty.                                     F:\MCP\projects\CAN\canBase\Source\CAN.c
00156e   d002     BRA       0x1574         	else { return FALSE;}                                                           F:\MCP\projects\CAN\canBase\Source\CAN.c
001570   0e00     MOVLW     0x0                                                                                             
001572   d0b9     BRA       0x16e6                                                                                          
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
001574   0eef     MOVLW     0xef           	if (prio<0 || prio>3) prio = 0;                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
001576   cfdb     MOVFF     0xfdb,0x14                                                                                      
001578   f014                                                                                                               
00157a   3414     RLCF      0x14,0x0,0x0                                                                                    
00157c   e20e     BC        0x159a                                                                                          
00157e   0eef     MOVLW     0xef                                                                                            
001580   cfdb     MOVFF     0xfdb,0x15                                                                                      
001582   f015                                                                                                               
001584   0e03     MOVLW     0x3                                                                                             
001586   6ee7     MOVWF     0xe7,0x0                                                                                        
001588   1815     XORWF     0x15,0x0,0x0                                                                                    
00158a   aee8     BTFSS     0xe8,0x7,0x0                                                                                    
00158c   d002     BRA       0x1592                                                                                          
00158e   3415     RLCF      0x15,0x0,0x0                                                                                    
001590   d003     BRA       0x1598                                                                                          
001592   50e7     MOVF      0xe7,0x0,0x0                                                                                    
001594   80d8     BSF       0xd8,0x0,0x0                                                                                    
001596   5415     SUBFWB    0x15,0x0,0x0                                                                                    
001598   e202     BC        0x159e                                                                                          
00159a   0eef     MOVLW     0xef                                                                                            
00159c   6adb     CLRF      0xdb,0x0                                                                                        
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		// Append my id and nid                                                        F:\MCP\projects\CAN\canBase\Source\CAN.c
00159e   0ef3     MOVLW     0xf3           		cm.nid	= MY_NID;                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
0015a0   c09c     MOVFF     0x9c,0xfdb                                                                                      
0015a2   ffdb                                                                                                               
0015a4   0ef4     MOVLW     0xf4           		cm.sid	= MY_ID;                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
0015a6   c09a     MOVFF     0x9a,0xfdb                                                                                      
0015a8   ffdb                                                                                                               
0015aa   0ef5     MOVLW     0xf5                                                                                            
0015ac   c09b     MOVFF     0x9b,0xfdb                                                                                      
0015ae   ffdb                                                                                                               
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		//RXB0SIDH 28 27 26 25 24 23 22 21                                             F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                   //RXB0SIDL 20 19 18 xx xx xx 17 16                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                   //RXB0EIDH 15 14 13 12 11 10 09 08                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                   //RXB0EIDL 07 06 05 04 03 02 01 00                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		//funct xx xx xx xx 28 27 26 25                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		//funcc xx xx xx xx xx xx 24 23 22 21 20 19 18 17 16 15                        F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		//nid   xx xx 14 13 12 11 10 09                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		//sid   xx xx xx xx xx xx xx 08 07 06 05 04 03 02 01 00                        F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
0015b0   0ef1     MOVLW     0xf1           		RXB0SIDH = (BYTE)((cm.funct & 0x0F)<<4)+(BYTE)((cm.funcc & 0x03C0)>>6);        F:\MCP\projects\CAN\canBase\Source\CAN.c
0015b2   cfdb     MOVFF     0xfdb,0x14                                                                                      
0015b4   f014                                                                                                               
0015b6   0ef2     MOVLW     0xf2                                                                                            
0015b8   cfdb     MOVFF     0xfdb,0x15                                                                                      
0015ba   f015                                                                                                               
0015bc   0ec0     MOVLW     0xc0                                                                                            
0015be   1614     ANDWF     0x14,0x1,0x0                                                                                    
0015c0   0e03     MOVLW     0x3                                                                                             
0015c2   1615     ANDWF     0x15,0x1,0x0                                                                                    
0015c4   0e06     MOVLW     0x6                                                                                             
0015c6   90d8     BCF       0xd8,0x0,0x0                                                                                    
0015c8   3215     RRCF      0x15,0x1,0x0                                                                                    
0015ca   3214     RRCF      0x14,0x1,0x0                                                                                    
0015cc   04e8     DECF      0xe8,0x0,0x0                                                                                    
0015ce   e1fb     BNZ       0x15c6                                                                                          
0015d0   0ef0     MOVLW     0xf0                                                                                            
0015d2   50db     MOVF      0xdb,0x0,0x0                                                                                    
0015d4   0b0f     ANDLW     0xf                                                                                             
0015d6   0d10     MULLW     0x10                                                                                            
0015d8   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0015da   2414     ADDWF     0x14,0x0,0x0                                                                                    
0015dc   6e61     MOVWF     0x61,0x0                                                                                        
0015de   0e06     MOVLW     0x6            		RXB0SIDL = (BYTE)((cm.funcc & 0x003F)<<2)+(BYTE)((cm.funcc & 0x0006)>>1);      F:\MCP\projects\CAN\canBase\Source\CAN.c
0015e0   6ee7     MOVWF     0xe7,0x0                                                                                        
0015e2   0ef1     MOVLW     0xf1                                                                                            
0015e4   cfdb     MOVFF     0xfdb,0x16                                                                                      
0015e6   f016                                                                                                               
0015e8   0ef2     MOVLW     0xf2                                                                                            
0015ea   cfdb     MOVFF     0xfdb,0x17                                                                                      
0015ec   f017                                                                                                               
0015ee   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0015f0   1616     ANDWF     0x16,0x1,0x0                                                                                    
0015f2   6a17     CLRF      0x17,0x0                                                                                        
0015f4   90d8     BCF       0xd8,0x0,0x0                                                                                    
0015f6   3217     RRCF      0x17,0x1,0x0                                                                                    
0015f8   3216     RRCF      0x16,0x1,0x0                                                                                    
0015fa   0e3f     MOVLW     0x3f                                                                                            
0015fc   6ee7     MOVWF     0xe7,0x0                                                                                        
0015fe   0ef1     MOVLW     0xf1                                                                                            
001600   cfdb     MOVFF     0xfdb,0x14                                                                                      
001602   f014                                                                                                               
001604   0ef2     MOVLW     0xf2                                                                                            
001606   cfdb     MOVFF     0xfdb,0x15                                                                                      
001608   f015                                                                                                               
00160a   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00160c   1614     ANDWF     0x14,0x1,0x0                                                                                    
00160e   6a15     CLRF      0x15,0x0                                                                                        
001610   90d8     BCF       0xd8,0x0,0x0                                                                                    
001612   3614     RLCF      0x14,0x1,0x0                                                                                    
001614   3615     RLCF      0x15,0x1,0x0                                                                                    
001616   90d8     BCF       0xd8,0x0,0x0                                                                                    
001618   3614     RLCF      0x14,0x1,0x0                                                                                    
00161a   3615     RLCF      0x15,0x1,0x0                                                                                    
00161c   5014     MOVF      0x14,0x0,0x0                                                                                    
00161e   2416     ADDWF     0x16,0x0,0x0                                                                                    
001620   6e62     MOVWF     0x62,0x0                                                                                        
001622   0ef4     MOVLW     0xf4           		RXB0EIDH = (BYTE)((cm.funcc & 0x0001)<<7)+(BYTE)((cm.nid & 0x3F)<<1)+(BYTE)((cm.sid & 0x0100)>>8); F:\MCP\projects\CAN\canBase\Source\CAN.c
001624   cfdb     MOVFF     0xfdb,0x16                                                                                      
001626   f016                                                                                                               
001628   0ef5     MOVLW     0xf5                                                                                            
00162a   cfdb     MOVFF     0xfdb,0x17                                                                                      
00162c   f017                                                                                                               
00162e   0e00     MOVLW     0x0                                                                                             
001630   1616     ANDWF     0x16,0x1,0x0                                                                                    
001632   0e01     MOVLW     0x1                                                                                             
001634   1617     ANDWF     0x17,0x1,0x0                                                                                    
001636   c017     MOVFF     0x17,0x16                                                                                       
001638   f016                                                                                                               
00163a   6a17     CLRF      0x17,0x0                                                                                        
00163c   0e01     MOVLW     0x1                                                                                             
00163e   6ee7     MOVWF     0xe7,0x0                                                                                        
001640   0ef1     MOVLW     0xf1                                                                                            
001642   cfdb     MOVFF     0xfdb,0x14                                                                                      
001644   f014                                                                                                               
001646   0ef2     MOVLW     0xf2                                                                                            
001648   cfdb     MOVFF     0xfdb,0x15                                                                                      
00164a   f015                                                                                                               
00164c   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00164e   1614     ANDWF     0x14,0x1,0x0                                                                                    
001650   6a15     CLRF      0x15,0x0                                                                                        
001652   0e07     MOVLW     0x7                                                                                             
001654   90d8     BCF       0xd8,0x0,0x0                                                                                    
001656   3614     RLCF      0x14,0x1,0x0                                                                                    
001658   3615     RLCF      0x15,0x1,0x0                                                                                    
00165a   04e8     DECF      0xe8,0x0,0x0                                                                                    
00165c   e1fb     BNZ       0x1654                                                                                          
00165e   0ef3     MOVLW     0xf3                                                                                            
001660   50db     MOVF      0xdb,0x0,0x0                                                                                    
001662   0b3f     ANDLW     0x3f                                                                                            
001664   24e8     ADDWF     0xe8,0x0,0x0                                                                                    
001666   2414     ADDWF     0x14,0x0,0x0                                                                                    
001668   2416     ADDWF     0x16,0x0,0x0                                                                                    
00166a   6e63     MOVWF     0x63,0x0                                                                                        
00166c   0eff     MOVLW     0xff           		RXB0EIDL = (BYTE)((cm.sid & 0x00FF));                                          F:\MCP\projects\CAN\canBase\Source\CAN.c
00166e   6ee7     MOVWF     0xe7,0x0                                                                                        
001670   0ef4     MOVLW     0xf4                                                                                            
001672   cfdb     MOVFF     0xfdb,0x14                                                                                      
001674   f014                                                                                                               
001676   0ef5     MOVLW     0xf5                                                                                            
001678   cfdb     MOVFF     0xfdb,0x15                                                                                      
00167a   f015                                                                                                               
00167c   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00167e   1614     ANDWF     0x14,0x1,0x0                                                                                    
001680   6a15     CLRF      0x15,0x0                                                                                        
001682   5014     MOVF      0x14,0x0,0x0                                                                                    
001684   6e64     MOVWF     0x64,0x0                                                                                        
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		// Data length                                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
001686   6a65     CLRF      0x65,0x0       		RXB0DLC = 0;                                                                   F:\MCP\projects\CAN\canBase\Source\CAN.c
001688   0ef6     MOVLW     0xf6           		if (cm.data_length>8) RXB0DLC=8; else RXB0DLC=cm.data_length;                  F:\MCP\projects\CAN\canBase\Source\CAN.c
00168a   50db     MOVF      0xdb,0x0,0x0                                                                                    
00168c   0808     SUBLW     0x8                                                                                             
00168e   e203     BC        0x1696                                                                                          
001690   0e08     MOVLW     0x8                                                                                             
001692   6e65     MOVWF     0x65,0x0                                                                                        
001694   d003     BRA       0x169c                                                                                          
001696   0ef6     MOVLW     0xf6                                                                                            
001698   50db     MOVF      0xdb,0x0,0x0                                                                                    
00169a   6e65     MOVWF     0x65,0x0                                                                                        
                                           		                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		// NOT Remote request                                                          F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		_asm                                                                           F:\MCP\projects\CAN\canBase\Source\CAN.c
00169c   9c65     BCF       0x65,0x6,0x0   			bcf RXB0DLC, 6, 0                                                             F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		_endasm                                                                        F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		                                                                               F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		// Data one bye one, for speed                                                 F:\MCP\projects\CAN\canBase\Source\CAN.c
00169e   0ef7     MOVLW     0xf7           		RXB0D0=cm.data[0];	RXB0D1=cm.data[1];                                          F:\MCP\projects\CAN\canBase\Source\CAN.c
0016a0   50db     MOVF      0xdb,0x0,0x0                                                                                    
0016a2   6e66     MOVWF     0x66,0x0                                                                                        
0016a4   0ef8     MOVLW     0xf8                                                                                            
0016a6   50db     MOVF      0xdb,0x0,0x0                                                                                    
0016a8   6e67     MOVWF     0x67,0x0                                                                                        
0016aa   0ef9     MOVLW     0xf9           		RXB0D2=cm.data[2]; 	RXB0D3=cm.data[3];                                         F:\MCP\projects\CAN\canBase\Source\CAN.c
0016ac   50db     MOVF      0xdb,0x0,0x0                                                                                    
0016ae   6e68     MOVWF     0x68,0x0                                                                                        
0016b0   0efa     MOVLW     0xfa                                                                                            
0016b2   50db     MOVF      0xdb,0x0,0x0                                                                                    
0016b4   6e69     MOVWF     0x69,0x0                                                                                        
0016b6   0efb     MOVLW     0xfb           		RXB0D4=cm.data[4]; 	RXB0D5=cm.data[5];                                         F:\MCP\projects\CAN\canBase\Source\CAN.c
0016b8   50db     MOVF      0xdb,0x0,0x0                                                                                    
0016ba   6e6a     MOVWF     0x6a,0x0                                                                                        
0016bc   0efc     MOVLW     0xfc                                                                                            
0016be   50db     MOVF      0xdb,0x0,0x0                                                                                    
0016c0   6e6b     MOVWF     0x6b,0x0                                                                                        
0016c2   0efd     MOVLW     0xfd           		RXB0D6=cm.data[6]; 	RXB0D7=cm.data[7];                                         F:\MCP\projects\CAN\canBase\Source\CAN.c
0016c4   50db     MOVF      0xdb,0x0,0x0                                                                                    
0016c6   6e6c     MOVWF     0x6c,0x0                                                                                        
0016c8   0efe     MOVLW     0xfe                                                                                            
0016ca   50db     MOVF      0xdb,0x0,0x0                                                                                    
0016cc   6e6d     MOVWF     0x6d,0x0                                                                                        
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		// set extended                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
0016ce   8662     BSF       0x62,0x3,0x0   		RXB0SIDLbits.EXID=1;                                                           F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		// Priority                                                                    F:\MCP\projects\CAN\canBase\Source\CAN.c
0016d0   0eef     MOVLW     0xef           		RXB0CON = (RXB0CON & 0b11111100) | prio;                                       F:\MCP\projects\CAN\canBase\Source\CAN.c
0016d2   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
0016d4   ffe6                                                                                                               
0016d6   0efc     MOVLW     0xfc                                                                                            
0016d8   1460     ANDWF     0x60,0x0,0x0                                                                                    
0016da   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0016dc   10e7     IORWF     0xe7,0x0,0x0                                                                                    
0016de   6e60     MOVWF     0x60,0x0                                                                                        
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		// mark as redy to transmit                                                    F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		_asm                                                                           F:\MCP\projects\CAN\canBase\Source\CAN.c
0016e0   8660     BSF       0x60,0x3,0x0   			bsf RXB0CON, 3, 0                                                             F:\MCP\projects\CAN\canBase\Source\CAN.c
                                           		_endasm                                                                        F:\MCP\projects\CAN\canBase\Source\CAN.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
0016e2   0e01     MOVLW     0x1            		return TRUE;                                                                   F:\MCP\projects\CAN\canBase\Source\CAN.c
0016e4   d000     BRA       0x16e6                                                                                          
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\CAN.c
0016e6   52e5     MOVF      0xe5,0x1,0x0   }                                                                                F:\MCP\projects\CAN\canBase\Source\CAN.c
0016e8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0016ea   ffd9                                                                                                               
0016ec   0012     RETURN    0x0                                                                                             
                                           /*********************************************************************           F:\MCP\projects\CAN\canBase\Source\Tick.c
                                            *                                                                               F:\MCP\projects\CAN\canBase\Source\Tick.c
                                            *                  Ticker module service                                        F:\MCP\projects\CAN\canBase\Source\Tick.c
                                            *                                                                               F:\MCP\projects\CAN\canBase\Source\Tick.c
                                            *********************************************************************           F:\MCP\projects\CAN\canBase\Source\Tick.c
                                            * FileName:        $HeadURL: http://svn.arune.se/svn/HomeAutomation/trunk/EmbeddedSoftware/PIC/canBase/Source/Tick.c $ F:\MCP\projects\CAN\canBase\Source\Tick.c
                                            * Last changed:	$LastChangedDate: 2006-11-14 10:55:38 +0100 (ti, 14 nov 2006) $ F:\MCP\projects\CAN\canBase\Source\Tick.c
                                            * By:				$LastChangedBy: johboh $                                               F:\MCP\projects\CAN\canBase\Source\Tick.c
                                            * Revision:		$Revision: 86 $                                                    F:\MCP\projects\CAN\canBase\Source\Tick.c
                                            ********************************************************************/           F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #define TICK_INCLUDE                                                             F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #include <Tick.h>                                                                F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #include <Compiler.h>                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #define TICK_TEMP_VALUE_1 ((INSTR_FREQ) / (TICKS_PER_SECOND * TICK_PRESCALE_VALUE)) F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #if TICK_TEMP_VALUE_1 > 60000                                                    F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #error TICK_PER_SECOND value cannot be programmed with current CLOCK_FREQ        F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #error Either lower TICK_PER_SECOND or manually configure the Timer              F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #endif                                                                           F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #define TICK_TEMP_VALUE         (65535 - TICK_TEMP_VALUE_1)                      F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #define TICK_COUNTER_HIGH       ((TICK_TEMP_VALUE >> 8) & 0xff)                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #define TICK_COUNTER_LOW        (TICK_TEMP_VALUE & 0xff)                         F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #if (TICK_PRESCALE_VALUE == 2)                                                   F:\MCP\projects\CAN\canBase\Source\Tick.c
                                               #define TIMER_PRESCALE  (0)                                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #elif ( TICK_PRESCALE_VALUE == 4 )                                               F:\MCP\projects\CAN\canBase\Source\Tick.c
                                               #define TIMER_PRESCALE  (1)                                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #elif ( TICK_PRESCALE_VALUE == 8 )                                               F:\MCP\projects\CAN\canBase\Source\Tick.c
                                               #define TIMER_PRESCALE  (2)                                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #elif ( TICK_PRESCALE_VALUE == 16 )                                              F:\MCP\projects\CAN\canBase\Source\Tick.c
                                               #define TIMER_PRESCALE  (3)                                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #elif ( TICK_PRESCALE_VALUE == 32 )                                              F:\MCP\projects\CAN\canBase\Source\Tick.c
                                               #define TIMER_PRESCALE  (4)                                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #elif ( TICK_PRESCALE_VALUE == 64 )                                              F:\MCP\projects\CAN\canBase\Source\Tick.c
                                               #define TIMER_PRESCALE  (5)                                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #elif ( TICK_PRESCALE_VALUE == 128 )                                             F:\MCP\projects\CAN\canBase\Source\Tick.c
                                               #define TIMER_PRESCALE  (6)                                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #elif ( TICK_PRESCALE_VALUE == 256 )                                             F:\MCP\projects\CAN\canBase\Source\Tick.c
                                               #define TIMER_PRESCALE  (7)                                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #else                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                               #error Invalid TICK_PRESCALE_VALUE specified.                                F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #endif                                                                           F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           TICK TickCount = 0;	// 10ms/unit                                                 F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           /*                                                                               F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Function: TickInit                                                             F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *                                                                                F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Input:	none                                                                    F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Output: Tick manager is initialized.                                           F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Pre-conditions: TickInit                                                       F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Affects: none                                                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Depends: none                                                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           */                                                                               F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           #define PERIOD (INSTR_FREQ/256/1000)*TICK_PERIOD_MS                              F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           void tickInit(void)                                                              F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           {                                                                                F:\MCP\projects\CAN\canBase\Source\Tick.c
                                               // Start the timer.                                                          F:\MCP\projects\CAN\canBase\Source\Tick.c
001f90   0e79     MOVLW     0x79               TMR0L = TICK_COUNTER_LOW;                                                    F:\MCP\projects\CAN\canBase\Source\Tick.c
001f92   6ed6     MOVWF     0xd6,0x0                                                                                        
001f94   0efe     MOVLW     0xfe               TMR0H = TICK_COUNTER_HIGH;                                                   F:\MCP\projects\CAN\canBase\Source\Tick.c
001f96   6ed7     MOVWF     0xd7,0x0                                                                                        
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                               // 16-BIT, internal timer, PSA set to 1:256                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
001f98   0e07     MOVLW     0x7                T0CON = 0b00000000 | TIMER_PRESCALE;                                         F:\MCP\projects\CAN\canBase\Source\Tick.c
001f9a   6ed5     MOVWF     0xd5,0x0                                                                                        
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                               // Start the timer.                                                          F:\MCP\projects\CAN\canBase\Source\Tick.c
001f9c   8ed5     BSF       0xd5,0x7,0x0       T0CONbits.TMR0ON = 1;                                                        F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
001f9e   84f2     BSF       0xf2,0x2,0x0       INTCONbits.TMR0IF = 1;                                                       F:\MCP\projects\CAN\canBase\Source\Tick.c
001fa0   8af2     BSF       0xf2,0x5,0x0       INTCONbits.TMR0IE = 1;                                                       F:\MCP\projects\CAN\canBase\Source\Tick.c
001fa2   0012     RETURN    0x0            }                                                                                F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           /*                                                                               F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Function: TickGet                                                              F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *                                                                                F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Input:	none                                                                    F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Output: Current tick value is given, 1 tick represents approximately 10ms      F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Pre-conditions: TickInit                                                       F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Affects: none                                                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Depends: none                                                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           */                                                                               F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           TICK tickGet(void)                                                               F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           {                                                                                F:\MCP\projects\CAN\canBase\Source\Tick.c
001fa4   c096     MOVFF     0x96,0x6           return TickCount;                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
001fa6   f006                                                                                                               
001fa8   c097     MOVFF     0x97,0x7                                                                                        
001faa   f007                                                                                                               
001fac   c098     MOVFF     0x98,0x8                                                                                        
001fae   f008                                                                                                               
001fb0   c099     MOVFF     0x99,0x9                                                                                        
001fb2   f009                                                                                                               
001fb4   d000     BRA       0x1fb6                                                                                          
001fb6   0012     RETURN    0x0            }                                                                                F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           /*                                                                               F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Function: tickUpdate                                                           F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *                                                                                F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Input:	none                                                                    F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Output: none                                                                   F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Pre-conditions: TickInit                                                       F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Affects: none                                                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           *	Depends: none                                                                  F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           */                                                                               F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           void tickUpdate(void)                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           {                                                                                F:\MCP\projects\CAN\canBase\Source\Tick.c
001fb8   a4f2     BTFSS     0xf2,0x2,0x0       if(INTCONbits.TMR0IF)                                                        F:\MCP\projects\CAN\canBase\Source\Tick.c
001fba   d00b     BRA       0x1fd2                                                                                          
                                               {                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
001fbc   0efe     MOVLW     0xfe                   TMR0H = TICK_COUNTER_HIGH;                                               F:\MCP\projects\CAN\canBase\Source\Tick.c
001fbe   6ed7     MOVWF     0xd7,0x0                                                                                        
001fc0   0e79     MOVLW     0x79                   TMR0L = TICK_COUNTER_LOW;                                                F:\MCP\projects\CAN\canBase\Source\Tick.c
001fc2   6ed6     MOVWF     0xd6,0x0                                                                                        
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
001fc4   0100     MOVLB     0x0                    TickCount++;                                                             F:\MCP\projects\CAN\canBase\Source\Tick.c
001fc6   2b96     INCF      0x96,0x1,0x1                                                                                    
001fc8   0e00     MOVLW     0x0                                                                                             
001fca   2397     ADDWFC    0x97,0x1,0x1                                                                                    
001fcc   2398     ADDWFC    0x98,0x1,0x1                                                                                    
001fce   2399     ADDWFC    0x99,0x1,0x1                                                                                    
                                                                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
001fd0   94f2     BCF       0xf2,0x2,0x0           INTCONbits.TMR0IF = 0;                                                   F:\MCP\projects\CAN\canBase\Source\Tick.c
                                               }                                                                            F:\MCP\projects\CAN\canBase\Source\Tick.c
001fd2   0012     RETURN    0x0            }                                                                                F:\MCP\projects\CAN\canBase\Source\Tick.c
                                           /*********************************************************************           F:\MCP\projects\CAN\canTemp\Source\Main.c
                                            *                                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
                                            *                  Main application                                             F:\MCP\projects\CAN\canTemp\Source\Main.c
                                            *                                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
                                            *********************************************************************           F:\MCP\projects\CAN\canTemp\Source\Main.c
                                            * FileName:        $HeadURL: http://svn.arune.se/svn/HomeAutomation/trunk/EmbeddedSoftware/PIC/canTemp/Source/Main.c $ F:\MCP\projects\CAN\canTemp\Source\Main.c
                                            * Last changed:	$LastChangedDate: 2007-01-30 12:53:25 +0100 (ti, 30 jan 2007) $ F:\MCP\projects\CAN\canTemp\Source\Main.c
                                            * By:				$LastChangedBy: johboh $                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
                                            * Revision:		$Revision: 276 $                                                   F:\MCP\projects\CAN\canTemp\Source\Main.c
                                            ********************************************************************/           F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #include <compiler.h>                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #include <stackTasks.h>                                                          F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #include <Tick.h>                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #include <funcdefs.h>                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #include <CAN.h>                                                                 F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #ifdef USE_ADC                                                                   F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	#include <adc.h>                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #endif                                                                           F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #ifdef USE_BLINDS                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	#include <blinds.h>                                                             F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #endif                                                                           F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           static void mainInit(void);                                                      F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
0019ec   cfd9     MOVFF     0xfd9,0xfe6    void main()                                                                      F:\MCP\projects\CAN\canTemp\Source\Main.c
0019ee   ffe6                                                                                                               
0019f0   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0019f2   ffd9                                                                                                               
0019f4   0e11     MOVLW     0x11                                                                                            
0019f6   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	static TICK t = 0;                                                              F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	CAN_MESSAGE outCm;                                                              F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	// Inits                                                                        F:\MCP\projects\CAN\canTemp\Source\Main.c
0019f8   d962     RCALL     0x1cbe         	mainInit();                                                                     F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
0019fa   ec2e     CALL      0x105c,0x0     	canInit();                                                                      F:\MCP\projects\CAN\canTemp\Source\Main.c
0019fc   f008                                                                                                               
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	#ifdef USE_ADC                                                                  F:\MCP\projects\CAN\canTemp\Source\Main.c
0019fe   0e0b     MOVLW     0xb            		adcInit(TRUE,0b1011);                                                          F:\MCP\projects\CAN\canTemp\Source\Main.c
001a00   6ee6     MOVWF     0xe6,0x0                                                                                        
001a02   0e01     MOVLW     0x1                                                                                             
001a04   6ee6     MOVWF     0xe6,0x0                                                                                        
001a06   ec77     CALL      0x16ee,0x0                                                                                      
001a08   f00b                                                                                                               
001a0a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a0c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	#endif                                                                          F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	#ifdef USE_BLINDS                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		blindsInit();                                                                  F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	#endif                                                                          F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
001b7c   d748     BRA       0x1a0e         	while(1)                                                                        F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	{                                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		static TICK t = 0;                                                             F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		static TICK temperature = 0;                                                   F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		static BYTE lastTemperature = TEMPERATURE_INSIDE;                              F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		static signed int angle = 90;                                                  F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		static TICK blinds = 0;                                                        F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		                                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
001a0e   ecd2     CALL      0x1fa4,0x0     		if ((tickGet()-t)>TICK_SECOND)                                                 F:\MCP\projects\CAN\canTemp\Source\Main.c
001a10   f00f                                                                                                               
001a12   0100     MOVLB     0x0                                                                                             
001a14   5177     MOVF      0x77,0x0,0x1                                                                                    
001a16   5c06     SUBWF     0x6,0x0,0x0                                                                                     
001a18   6e14     MOVWF     0x14,0x0                                                                                        
001a1a   5178     MOVF      0x78,0x0,0x1                                                                                    
001a1c   5807     SUBWFB    0x7,0x0,0x0                                                                                     
001a1e   6e15     MOVWF     0x15,0x0                                                                                        
001a20   5179     MOVF      0x79,0x0,0x1                                                                                    
001a22   5808     SUBWFB    0x8,0x0,0x0                                                                                     
001a24   6e16     MOVWF     0x16,0x0                                                                                        
001a26   517a     MOVF      0x7a,0x0,0x1                                                                                    
001a28   5809     SUBWFB    0x9,0x0,0x0                                                                                     
001a2a   6e17     MOVWF     0x17,0x0                                                                                        
001a2c   80d8     BSF       0xd8,0x0,0x0                                                                                    
001a2e   0e64     MOVLW     0x64                                                                                            
001a30   5414     SUBFWB    0x14,0x0,0x0                                                                                    
001a32   0e00     MOVLW     0x0                                                                                             
001a34   5415     SUBFWB    0x15,0x0,0x0                                                                                    
001a36   0e00     MOVLW     0x0                                                                                             
001a38   5416     SUBFWB    0x16,0x0,0x0                                                                                    
001a3a   0e00     MOVLW     0x0                                                                                             
001a3c   5417     SUBFWB    0x17,0x0,0x0                                                                                    
001a3e   e20b     BC        0x1a56                                                                                          
                                           		{                                                                              F:\MCP\projects\CAN\canTemp\Source\Main.c
001a40   7282     BTG       0x82,0x1,0x0   			LED0_IO=~LED0_IO;                                                             F:\MCP\projects\CAN\canTemp\Source\Main.c
001a42   ecd2     CALL      0x1fa4,0x0     			t = tickGet();                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
001a44   f00f                                                                                                               
001a46   c006     MOVFF     0x6,0x77                                                                                        
001a48   f077                                                                                                               
001a4a   c007     MOVFF     0x7,0x78                                                                                        
001a4c   f078                                                                                                               
001a4e   c008     MOVFF     0x8,0x79                                                                                        
001a50   f079                                                                                                               
001a52   c009     MOVFF     0x9,0x7a                                                                                        
001a54   f07a                                                                                                               
                                           		}                                                                              F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		#ifdef USE_BLINDS                                                              F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		if ((tickGet()-blinds)>2*TICK_SECOND)                                          F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		{                                                                              F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           			angle = (angle>0?-45:45);                                                     F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           			blindsTurn(angle);                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           			blinds = tickGet();                                                           F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		}                                                                              F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		#endif                                                                         F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		#ifdef USE_ADC                                                                 F:\MCP\projects\CAN\canTemp\Source\Main.c
001a56   ecd2     CALL      0x1fa4,0x0     		if ((tickGet()-temperature)>TICK_SECOND*2) // Each 2 second, read temperature. F:\MCP\projects\CAN\canTemp\Source\Main.c
001a58   f00f                                                                                                               
001a5a   0100     MOVLB     0x0                                                                                             
001a5c   517b     MOVF      0x7b,0x0,0x1                                                                                    
001a5e   5c06     SUBWF     0x6,0x0,0x0                                                                                     
001a60   6e14     MOVWF     0x14,0x0                                                                                        
001a62   517c     MOVF      0x7c,0x0,0x1                                                                                    
001a64   5807     SUBWFB    0x7,0x0,0x0                                                                                     
001a66   6e15     MOVWF     0x15,0x0                                                                                        
001a68   517d     MOVF      0x7d,0x0,0x1                                                                                    
001a6a   5808     SUBWFB    0x8,0x0,0x0                                                                                     
001a6c   6e16     MOVWF     0x16,0x0                                                                                        
001a6e   517e     MOVF      0x7e,0x0,0x1                                                                                    
001a70   5809     SUBWFB    0x9,0x0,0x0                                                                                     
001a72   6e17     MOVWF     0x17,0x0                                                                                        
001a74   80d8     BSF       0xd8,0x0,0x0                                                                                    
001a76   0ec8     MOVLW     0xc8                                                                                            
001a78   5414     SUBFWB    0x14,0x0,0x0                                                                                    
001a7a   0e00     MOVLW     0x0                                                                                             
001a7c   5415     SUBFWB    0x15,0x0,0x0                                                                                    
001a7e   0e00     MOVLW     0x0                                                                                             
001a80   5416     SUBFWB    0x16,0x0,0x0                                                                                    
001a82   0e00     MOVLW     0x0                                                                                             
001a84   5417     SUBFWB    0x17,0x0,0x0                                                                                    
001a86   e215     BC        0x1ab2                                                                                          
                                           		{                                                                              F:\MCP\projects\CAN\canTemp\Source\Main.c
001a88   517f     MOVF      0x7f,0x0,0x1   			if (lastTemperature==TEMPERATURE_INSIDE) lastTemperature=TEMPERATURE_OUTSIDE; else lastTemperature=TEMPERATURE_INSIDE; F:\MCP\projects\CAN\canTemp\Source\Main.c
001a8a   e103     BNZ       0x1a92                                                                                          
001a8c   0e01     MOVLW     0x1                                                                                             
001a8e   6f7f     MOVWF     0x7f,0x1                                                                                        
001a90   d001     BRA       0x1a94                                                                                          
001a92   6b7f     CLRF      0x7f,0x1                                                                                        
001a94   c07f     MOVFF     0x7f,0xfe6     			adcConvert(lastTemperature);                                                  F:\MCP\projects\CAN\canTemp\Source\Main.c
001a96   ffe6                                                                                                               
001a98   ece5     CALL      0x17ca,0x0                                                                                      
001a9a   f00b                                                                                                               
001a9c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a9e   ecd2     CALL      0x1fa4,0x0     			temperature = tickGet();                                                      F:\MCP\projects\CAN\canTemp\Source\Main.c
001aa0   f00f                                                                                                               
001aa2   c006     MOVFF     0x6,0x7b                                                                                        
001aa4   f07b                                                                                                               
001aa6   c007     MOVFF     0x7,0x7c                                                                                        
001aa8   f07c                                                                                                               
001aaa   c008     MOVFF     0x8,0x7d                                                                                        
001aac   f07d                                                                                                               
001aae   c009     MOVFF     0x9,0x7e                                                                                        
001ab0   f07e                                                                                                               
                                           		}                                                                              F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		#endif                                                                         F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		#ifdef USE_ADC                                                                 F:\MCP\projects\CAN\canTemp\Source\Main.c
001ab2   ecf2     CALL      0x19e4,0x0     		if (adcDone()) // Has temperature, send it to the bus                          F:\MCP\projects\CAN\canTemp\Source\Main.c
001ab4   f00c                                                                                                               
001ab6   0900     IORLW     0x0                                                                                             
001ab8   e061     BZ        0x1b7c                                                                                          
                                           		{                                                                              F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           			BYTE decimal;                                                                 F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           			signed char tenth;                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
001aba   50d9     MOVF      0xd9,0x0,0x0   			temperatureRead(&tenth,&decimal);                                             F:\MCP\projects\CAN\canTemp\Source\Main.c
001abc   0f0f     ADDLW     0xf                                                                                             
001abe   6ee6     MOVWF     0xe6,0x0                                                                                        
001ac0   0e00     MOVLW     0x0                                                                                             
001ac2   20da     ADDWFC    0xda,0x0,0x0                                                                                    
001ac4   6ee6     MOVWF     0xe6,0x0                                                                                        
001ac6   50d9     MOVF      0xd9,0x0,0x0                                                                                    
001ac8   0f10     ADDLW     0x10                                                                                            
001aca   6ee6     MOVWF     0xe6,0x0                                                                                        
001acc   0e00     MOVLW     0x0                                                                                             
001ace   20da     ADDWFC    0xda,0x0,0x0                                                                                    
001ad0   6ee6     MOVWF     0xe6,0x0                                                                                        
001ad2   ec10     CALL      0x1820,0x0                                                                                      
001ad4   f00c                                                                                                               
001ad6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ad8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ada   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001adc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
001ade   0e01     MOVLW     0x1            			outCm.funct 					= FUNCT_SENSORS;                                             F:\MCP\projects\CAN\canTemp\Source\Main.c
001ae0   6edf     MOVWF     0xdf,0x0                                                                                        
001ae2   0100     MOVLB     0x0            			outCm.funcc 					= (lastTemperature==TEMPERATURE_INSIDE?FUNCC_SENSORS_TEMPERATURE_INSIDE:FUNCC_SENSORS_TEMPERATURE_OUTSIDE); F:\MCP\projects\CAN\canTemp\Source\Main.c
001ae4   517f     MOVF      0x7f,0x0,0x1                                                                                    
001ae6   e102     BNZ       0x1aec                                                                                          
001ae8   0e10     MOVLW     0x10                                                                                            
001aea   d001     BRA       0x1aee                                                                                          
001aec   0e11     MOVLW     0x11                                                                                            
001aee   6e14     MOVWF     0x14,0x0                                                                                        
001af0   6a15     CLRF      0x15,0x0                                                                                        
001af2   be14     BTFSC     0x14,0x7,0x0                                                                                    
001af4   6815     SETF      0x15,0x0                                                                                        
001af6   0e01     MOVLW     0x1                                                                                             
001af8   c014     MOVFF     0x14,0xfdb                                                                                      
001afa   ffdb                                                                                                               
001afc   0e02     MOVLW     0x2                                                                                             
001afe   c015     MOVFF     0x15,0xfdb                                                                                      
001b00   ffdb                                                                                                               
001b02   6ef3     MOVWF     0xf3,0x0       			outCm.data_length 				= 2;                                                    F:\MCP\projects\CAN\canTemp\Source\Main.c
001b04   0e06     MOVLW     0x6                                                                                             
001b06   cff3     MOVFF     0xff3,0xfdb                                                                                     
001b08   ffdb                                                                                                               
001b0a   0e10     MOVLW     0x10           			outCm.data[1]					= tenth; //  signed 10 an 1 decimal.                        F:\MCP\projects\CAN\canTemp\Source\Main.c
001b0c   50db     MOVF      0xdb,0x0,0x0                                                                                    
001b0e   6ee7     MOVWF     0xe7,0x0                                                                                        
001b10   0e08     MOVLW     0x8                                                                                             
001b12   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
001b14   ffdb                                                                                                               
001b16   0e0f     MOVLW     0xf            			outCm.data[0]					= decimal; //  Decimal value, 0-9                           F:\MCP\projects\CAN\canTemp\Source\Main.c
001b18   50db     MOVF      0xdb,0x0,0x0                                                                                    
001b1a   6ee7     MOVWF     0xe7,0x0                                                                                        
001b1c   0e07     MOVLW     0x7                                                                                             
001b1e   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
001b20   ffdb                                                                                                               
001b22   0e02     MOVLW     0x2            			while(!canSendMessage(outCm,PRIO_HIGH));                                      F:\MCP\projects\CAN\canTemp\Source\Main.c
001b24   6ee6     MOVWF     0xe6,0x0                                                                                        
001b26   cfd9     MOVFF     0xfd9,0xfe9                                                                                     
001b28   ffe9                                                                                                               
001b2a   cfda     MOVFF     0xfda,0xfea                                                                                     
001b2c   ffea                                                                                                               
001b2e   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b30   ffe6                                                                                                               
001b32   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b34   ffe6                                                                                                               
001b36   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b38   ffe6                                                                                                               
001b3a   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b3c   ffe6                                                                                                               
001b3e   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b40   ffe6                                                                                                               
001b42   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b44   ffe6                                                                                                               
001b46   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b48   ffe6                                                                                                               
001b4a   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b4c   ffe6                                                                                                               
001b4e   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b50   ffe6                                                                                                               
001b52   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b54   ffe6                                                                                                               
001b56   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b58   ffe6                                                                                                               
001b5a   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b5c   ffe6                                                                                                               
001b5e   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b60   ffe6                                                                                                               
001b62   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b64   ffe6                                                                                                               
001b66   cfee     MOVFF     0xfee,0xfe6                                                                                     
001b68   ffe6                                                                                                               
001b6a   ec9e     CALL      0x153c,0x0                                                                                      
001b6c   f00a                                                                                                               
001b6e   6e14     MOVWF     0x14,0x0                                                                                        
001b70   0e10     MOVLW     0x10                                                                                            
001b72   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
001b74   5014     MOVF      0x14,0x0,0x0                                                                                    
001b76   0900     IORLW     0x0                                                                                             
001b78   e101     BNZ       0x1b7c                                                                                          
001b7a   d7d3     BRA       0x1b22                                                                                          
                                           		}                                                                              F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		#endif                                                                         F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	}                                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
001b7e   0e11     MOVLW     0x11           }                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
001b80   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
001b82   e202     BC        0x1b88                                                                                          
001b84   6ae1     CLRF      0xe1,0x0                                                                                        
001b86   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b88   6ee1     MOVWF     0xe1,0x0                                                                                        
001b8a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b8c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001b8e   ffd9                                                                                                               
001b90   0012     RETURN    0x0                                                                                             
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #pragma interrupt high_isr                                                       F:\MCP\projects\CAN\canTemp\Source\Main.c
001b92   cfda     MOVFF     0xfda,0xfe4    void high_isr(void)                                                              F:\MCP\projects\CAN\canTemp\Source\Main.c
001b94   ffe4                                                                                                               
001b96   cfe2     MOVFF     0xfe2,0xfda                                                                                     
001b98   ffda                                                                                                               
001b9a   cfe9     MOVFF     0xfe9,0xfe4                                                                                     
001b9c   ffe4                                                                                                               
001b9e   cfea     MOVFF     0xfea,0xfe4                                                                                     
001ba0   ffe4                                                                                                               
001ba2   cff6     MOVFF     0xff6,0xfe4                                                                                     
001ba4   ffe4                                                                                                               
001ba6   cff7     MOVFF     0xff7,0xfe4                                                                                     
001ba8   ffe4                                                                                                               
001baa   cff5     MOVFF     0xff5,0xfe4                                                                                     
001bac   ffe4                                                                                                               
001bae   cff3     MOVFF     0xff3,0xfe4                                                                                     
001bb0   ffe4                                                                                                               
001bb2   cff4     MOVFF     0xff4,0xfe4                                                                                     
001bb4   ffe4                                                                                                               
001bb6   cffa     MOVFF     0xffa,0xfe4                                                                                     
001bb8   ffe4                                                                                                               
001bba   ee00     LFSR      0x0,0x0                                                                                         
001bbc   f000                                                                                                               
001bbe   0e14     MOVLW     0x14                                                                                            
001bc0   04e8     DECF      0xe8,0x0,0x0                                                                                    
001bc2   e303     BNC       0x1bca                                                                                          
001bc4   cfee     MOVFF     0xfee,0xfe4                                                                                     
001bc6   ffe4                                                                                                               
001bc8   d7fb     BRA       0x1bc0                                                                                          
001bca   ee00     LFSR      0x0,0x14                                                                                        
001bcc   f014                                                                                                               
001bce   0e0e     MOVLW     0xe                                                                                             
001bd0   04e8     DECF      0xe8,0x0,0x0                                                                                    
001bd2   e303     BNC       0x1bda                                                                                          
001bd4   cfee     MOVFF     0xfee,0xfe4                                                                                     
001bd6   ffe4                                                                                                               
001bd8   d7fb     BRA       0x1bd0                                                                                          
001bda   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
001bdc   ecb3     CALL      0x1166,0x0     	canISR();                                                                       F:\MCP\projects\CAN\canTemp\Source\Main.c
001bde   f008                                                                                                               
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	#ifdef USE_BLINDS                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           		blindsISR();                                                                   F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	#endif                                                                          F:\MCP\projects\CAN\canTemp\Source\Main.c
001be0   52e5     MOVF      0xe5,0x1,0x0   }                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
001be2   ee00     LFSR      0x0,0x21                                                                                        
001be4   f021                                                                                                               
001be6   0e0e     MOVLW     0xe                                                                                             
001be8   04e8     DECF      0xe8,0x0,0x0                                                                                    
001bea   e303     BNC       0x1bf2                                                                                          
001bec   cfe5     MOVFF     0xfe5,0xfed                                                                                     
001bee   ffed                                                                                                               
001bf0   d7fb     BRA       0x1be8                                                                                          
001bf2   ee00     LFSR      0x0,0x13                                                                                        
001bf4   f013                                                                                                               
001bf6   0e14     MOVLW     0x14                                                                                            
001bf8   04e8     DECF      0xe8,0x0,0x0                                                                                    
001bfa   e303     BNC       0x1c02                                                                                          
001bfc   cfe5     MOVFF     0xfe5,0xfed                                                                                     
001bfe   ffed                                                                                                               
001c00   d7fb     BRA       0x1bf8                                                                                          
001c02   cfe5     MOVFF     0xfe5,0xffa                                                                                     
001c04   fffa                                                                                                               
001c06   cfe5     MOVFF     0xfe5,0xff4                                                                                     
001c08   fff4                                                                                                               
001c0a   cfe5     MOVFF     0xfe5,0xff3                                                                                     
001c0c   fff3                                                                                                               
001c0e   cfe5     MOVFF     0xfe5,0xff5                                                                                     
001c10   fff5                                                                                                               
001c12   cfe5     MOVFF     0xfe5,0xff7                                                                                     
001c14   fff7                                                                                                               
001c16   cfe5     MOVFF     0xfe5,0xff6                                                                                     
001c18   fff6                                                                                                               
001c1a   cfe5     MOVFF     0xfe5,0xfea                                                                                     
001c1c   ffea                                                                                                               
001c1e   cfe5     MOVFF     0xfe5,0xfe9                                                                                     
001c20   ffe9                                                                                                               
001c22   cfe5     MOVFF     0xfe5,0xfda                                                                                     
001c24   ffda                                                                                                               
001c26   0011     RETFIE    0x1                                                                                             
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #pragma interrupt low_isr                                                        F:\MCP\projects\CAN\canTemp\Source\Main.c
001c28   cfda     MOVFF     0xfda,0xfe4    void low_isr(void)                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
001c2a   ffe4                                                                                                               
001c2c   cfe2     MOVFF     0xfe2,0xfda                                                                                     
001c2e   ffda                                                                                                               
001c30   cfe9     MOVFF     0xfe9,0xfe4                                                                                     
001c32   ffe4                                                                                                               
001c34   cfea     MOVFF     0xfea,0xfe4                                                                                     
001c36   ffe4                                                                                                               
001c38   cff6     MOVFF     0xff6,0xfe4                                                                                     
001c3a   ffe4                                                                                                               
001c3c   cff7     MOVFF     0xff7,0xfe4                                                                                     
001c3e   ffe4                                                                                                               
001c40   cff5     MOVFF     0xff5,0xfe4                                                                                     
001c42   ffe4                                                                                                               
001c44   cff3     MOVFF     0xff3,0xfe4                                                                                     
001c46   ffe4                                                                                                               
001c48   cff4     MOVFF     0xff4,0xfe4                                                                                     
001c4a   ffe4                                                                                                               
001c4c   cffa     MOVFF     0xffa,0xfe4                                                                                     
001c4e   ffe4                                                                                                               
001c50   ee00     LFSR      0x0,0x0                                                                                         
001c52   f000                                                                                                               
001c54   0e14     MOVLW     0x14                                                                                            
001c56   04e8     DECF      0xe8,0x0,0x0                                                                                    
001c58   e303     BNC       0x1c60                                                                                          
001c5a   cfee     MOVFF     0xfee,0xfe4                                                                                     
001c5c   ffe4                                                                                                               
001c5e   d7fb     BRA       0x1c56                                                                                          
001c60   ee00     LFSR      0x0,0x14                                                                                        
001c62   f014                                                                                                               
001c64   0e0e     MOVLW     0xe                                                                                             
001c66   04e8     DECF      0xe8,0x0,0x0                                                                                    
001c68   e303     BNC       0x1c70                                                                                          
001c6a   cfee     MOVFF     0xfee,0xfe4                                                                                     
001c6c   ffe4                                                                                                               
001c6e   d7fb     BRA       0x1c66                                                                                          
001c70   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	#ifdef USE_ADC                                                                  F:\MCP\projects\CAN\canTemp\Source\Main.c
001c72   ec91     CALL      0x1722,0x0     		adcISR();                                                                      F:\MCP\projects\CAN\canTemp\Source\Main.c
001c74   f00b                                                                                                               
                                           	#endif                                                                          F:\MCP\projects\CAN\canTemp\Source\Main.c
001c76   52e5     MOVF      0xe5,0x1,0x0   }                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
001c78   ee00     LFSR      0x0,0x21                                                                                        
001c7a   f021                                                                                                               
001c7c   0e0e     MOVLW     0xe                                                                                             
001c7e   04e8     DECF      0xe8,0x0,0x0                                                                                    
001c80   e303     BNC       0x1c88                                                                                          
001c82   cfe5     MOVFF     0xfe5,0xfed                                                                                     
001c84   ffed                                                                                                               
001c86   d7fb     BRA       0x1c7e                                                                                          
001c88   ee00     LFSR      0x0,0x13                                                                                        
001c8a   f013                                                                                                               
001c8c   0e14     MOVLW     0x14                                                                                            
001c8e   04e8     DECF      0xe8,0x0,0x0                                                                                    
001c90   e303     BNC       0x1c98                                                                                          
001c92   cfe5     MOVFF     0xfe5,0xfed                                                                                     
001c94   ffed                                                                                                               
001c96   d7fb     BRA       0x1c8e                                                                                          
001c98   cfe5     MOVFF     0xfe5,0xffa                                                                                     
001c9a   fffa                                                                                                               
001c9c   cfe5     MOVFF     0xfe5,0xff4                                                                                     
001c9e   fff4                                                                                                               
001ca0   cfe5     MOVFF     0xfe5,0xff3                                                                                     
001ca2   fff3                                                                                                               
001ca4   cfe5     MOVFF     0xfe5,0xff5                                                                                     
001ca6   fff5                                                                                                               
001ca8   cfe5     MOVFF     0xfe5,0xff7                                                                                     
001caa   fff7                                                                                                               
001cac   cfe5     MOVFF     0xfe5,0xff6                                                                                     
001cae   fff6                                                                                                               
001cb0   cfe5     MOVFF     0xfe5,0xfea                                                                                     
001cb2   ffea                                                                                                               
001cb4   cfe5     MOVFF     0xfe5,0xfe9                                                                                     
001cb6   ffe9                                                                                                               
001cb8   cfe5     MOVFF     0xfe5,0xfda                                                                                     
001cba   ffda                                                                                                               
001cbc   0011     RETFIE    0x1                                                                                             
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           /*                                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           *	Function: mainInit                                                             F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           *                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           *	Input:	none                                                                    F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           *	Output: none                                                                   F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           *	Pre-conditions: none                                                           F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           *	Affects: Se code                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           */                                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           void mainInit()                                                                  F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           {                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
001cbe   9294     BCF       0x94,0x1,0x0   	LED0_TRIS=0;                                                                    F:\MCP\projects\CAN\canTemp\Source\Main.c
001cc0   9894     BCF       0x94,0x4,0x0   	BLINDS0_TRIS=0;                                                                 F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	// Enable Interrupts                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
001cc2   8ef2     BSF       0xf2,0x7,0x0       INTCONbits.GIEH = 1;                                                         F:\MCP\projects\CAN\canTemp\Source\Main.c
001cc4   8cf2     BSF       0xf2,0x6,0x0       INTCONbits.GIEL = 1;                                                         F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	// Enable interrupt prirority                                                   F:\MCP\projects\CAN\canTemp\Source\Main.c
001cc6   8ed0     BSF       0xd0,0x7,0x0   	RCONbits.IPEN=1;                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
001cc8   0012     RETURN    0x0            }                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           /*                                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           *	Function: canParse                                                             F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           *                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           *	Input:	Received can message                                                    F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           *	Output: none                                                                   F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           *	Pre-conditions: canInit and received packet.                                   F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           *	Affects: Sensors/actuators/etc. See code.                                      F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           */                                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
001cca   cfd9     MOVFF     0xfd9,0xfe6    void canParse(CAN_MESSAGE cm)                                                    F:\MCP\projects\CAN\canTemp\Source\Main.c
001ccc   ffe6                                                                                                               
001cce   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001cd0   ffd9                                                                                                               
001cd2   0e0f     MOVLW     0xf                                                                                             
001cd4   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           	CAN_MESSAGE outCm;                                                              F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
001cd6   5ce1     SUBWF     0xe1,0x0,0x0   }                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
001cd8   e202     BC        0x1cde                                                                                          
001cda   6ae1     CLRF      0xe1,0x0                                                                                        
001cdc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001cde   6ee1     MOVWF     0xe1,0x0                                                                                        
001ce0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ce2   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001ce4   ffd9                                                                                                               
001ce6   0012     RETURN    0x0                                                                                             
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           // Below are mandantory when using bootloader                                    F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           // define DEBUG_MODE to use without bootloader.                                  F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #ifndef DEBUG_MODE                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           extern void _startup (void);                                                     F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #pragma code _RESET_INTERRUPT_VECTOR = 0x001000                                  F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           void _reset (void)                                                               F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           {                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
001000   ef00     GOTO      0x2000             _asm goto _startup _endasm                                                   F:\MCP\projects\CAN\canTemp\Source\Main.c
001002   f010                                                                                                               
001004   0012     RETURN    0x0            }                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #pragma code                                                                     F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #endif                                                                           F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #pragma code _HIGH_INTERRUPT_VECTOR = 0x001008                                   F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           void _high_ISR (void)                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           {                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
001008   efc9     GOTO      0x1b92         	_asm GOTO high_isr _endasm                                                      F:\MCP\projects\CAN\canTemp\Source\Main.c
00100a   f00d                                                                                                               
00100c   0012     RETURN    0x0            }                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #pragma code                                                                     F:\MCP\projects\CAN\canTemp\Source\Main.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #pragma code _LOW_INTERRUPT_VECTOR = 0x001018                                    F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           void _low_ISR (void)                                                             F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           {                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
001018   ef14     GOTO      0x1c28             _asm GOTO low_isr _endasm                                                    F:\MCP\projects\CAN\canTemp\Source\Main.c
00101a   f00e                                                                                                               
00101c   0012     RETURN    0x0            }                                                                                F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           #pragma code                                                                     F:\MCP\projects\CAN\canTemp\Source\Main.c
                                           /*********************************************************************           F:\MCP\projects\CAN\Include\EEAccess.c
                                            *                                                                               F:\MCP\projects\CAN\Include\EEAccess.c
                                            *   Functions for reading and writing to EEPROM.                                F:\MCP\projects\CAN\Include\EEAccess.c
                                            *                                                                               F:\MCP\projects\CAN\Include\EEAccess.c
                                            *********************************************************************           F:\MCP\projects\CAN\Include\EEAccess.c
                                            * FileName:        	$HeadURL: http://svn.arune.se/svn/HomeAutomation/trunk/EmbeddedSoftware/PIC/Include/EEAccess.c $ F:\MCP\projects\CAN\Include\EEAccess.c
                                            * Last changed:	$LastChangedDate: 2006-11-20 21:31:03 +0100 (m√•, 20 nov 2006) $ F:\MCP\projects\CAN\Include\EEAccess.c
                                            * By:			$LastChangedBy: johboh $                                                F:\MCP\projects\CAN\Include\EEAccess.c
                                            * Revision:		$Revision: 139 $                                                   F:\MCP\projects\CAN\Include\EEAccess.c
                                            ********************************************************************/           F:\MCP\projects\CAN\Include\EEAccess.c
                                           #include <p18cxxx.h>                                                             F:\MCP\projects\CAN\Include\EEAccess.c
                                           #include <EEaccess.h>                                                            F:\MCP\projects\CAN\Include\EEAccess.c
                                                                                                                            F:\MCP\projects\CAN\Include\EEAccess.c
                                           /*                                                                               F:\MCP\projects\CAN\Include\EEAccess.c
                                           *	Function: EERead                                                               F:\MCP\projects\CAN\Include\EEAccess.c
                                           *                                                                                F:\MCP\projects\CAN\Include\EEAccess.c
                                           *	Input:	WORD address to read from.                                              F:\MCP\projects\CAN\Include\EEAccess.c
                                           *	Output: Byte read.                                                             F:\MCP\projects\CAN\Include\EEAccess.c
                                           *	Pre-conditions: none                                                           F:\MCP\projects\CAN\Include\EEAccess.c
                                           *	Affects: none.                                                                 F:\MCP\projects\CAN\Include\EEAccess.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\Include\EEAccess.c
                                           */                                                                               F:\MCP\projects\CAN\Include\EEAccess.c
001ce8   cfd9     MOVFF     0xfd9,0xfe6    BYTE EERead(WORD addr)                                                           F:\MCP\projects\CAN\Include\EEAccess.c
001cea   ffe6                                                                                                               
001cec   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001cee   ffd9                                                                                                               
                                           {                                                                                F:\MCP\projects\CAN\Include\EEAccess.c
001cf0   0efd     MOVLW     0xfd           	EEADRH=(BYTE)(addr>>8);                                                         F:\MCP\projects\CAN\Include\EEAccess.c
001cf2   cfdb     MOVFF     0xfdb,0x14                                                                                      
001cf4   f014                                                                                                               
001cf6   0efe     MOVLW     0xfe                                                                                            
001cf8   cfdb     MOVFF     0xfdb,0x15                                                                                      
001cfa   f015                                                                                                               
001cfc   c015     MOVFF     0x15,0x14                                                                                       
001cfe   f014                                                                                                               
001d00   6a15     CLRF      0x15,0x0                                                                                        
001d02   5014     MOVF      0x14,0x0,0x0                                                                                    
001d04   6eaa     MOVWF     0xaa,0x0                                                                                        
001d06   0eff     MOVLW     0xff           	EEADR=(BYTE)(addr & 0xFF);                                                      F:\MCP\projects\CAN\Include\EEAccess.c
001d08   6ee7     MOVWF     0xe7,0x0                                                                                        
001d0a   0efd     MOVLW     0xfd                                                                                            
001d0c   cfdb     MOVFF     0xfdb,0x14                                                                                      
001d0e   f014                                                                                                               
001d10   0efe     MOVLW     0xfe                                                                                            
001d12   cfdb     MOVFF     0xfdb,0x15                                                                                      
001d14   f015                                                                                                               
001d16   50e7     MOVF      0xe7,0x0,0x0                                                                                    
001d18   1614     ANDWF     0x14,0x1,0x0                                                                                    
001d1a   6a15     CLRF      0x15,0x0                                                                                        
001d1c   5014     MOVF      0x14,0x0,0x0                                                                                    
001d1e   6ea9     MOVWF     0xa9,0x0                                                                                        
001d20   9ea6     BCF       0xa6,0x7,0x0   	EECON1bits.EEPGD=0;                                                             F:\MCP\projects\CAN\Include\EEAccess.c
001d22   9ca6     BCF       0xa6,0x6,0x0   	EECON1bits.CFGS=0;                                                              F:\MCP\projects\CAN\Include\EEAccess.c
001d24   80a6     BSF       0xa6,0x0,0x0   	EECON1bits.RD=1;                                                                F:\MCP\projects\CAN\Include\EEAccess.c
001d26   50a8     MOVF      0xa8,0x0,0x0   	return EEDATA;	                                                                 F:\MCP\projects\CAN\Include\EEAccess.c
001d28   d000     BRA       0x1d2a                                                                                          
001d2a   52e5     MOVF      0xe5,0x1,0x0   }                                                                                F:\MCP\projects\CAN\Include\EEAccess.c
001d2c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001d2e   ffd9                                                                                                               
001d30   0012     RETURN    0x0                                                                                             
                                                                                                                            F:\MCP\projects\CAN\Include\EEAccess.c
                                                                                                                            F:\MCP\projects\CAN\Include\EEAccess.c
                                           /*                                                                               F:\MCP\projects\CAN\Include\EEAccess.c
                                           *	Function: EEWrite                                                              F:\MCP\projects\CAN\Include\EEAccess.c
                                           *                                                                                F:\MCP\projects\CAN\Include\EEAccess.c
                                           *	Input:	WORD address to write to and BYTE data to write.                        F:\MCP\projects\CAN\Include\EEAccess.c
                                           *	Output: none.                                                                  F:\MCP\projects\CAN\Include\EEAccess.c
                                           *	Pre-conditions: none                                                           F:\MCP\projects\CAN\Include\EEAccess.c
                                           *	Affects: none.                                                                 F:\MCP\projects\CAN\Include\EEAccess.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\Include\EEAccess.c
                                           */                                                                               F:\MCP\projects\CAN\Include\EEAccess.c
001d32   cfd9     MOVFF     0xfd9,0xfe6    void EEWrite(WORD addr,BYTE data)                                                F:\MCP\projects\CAN\Include\EEAccess.c
001d34   ffe6                                                                                                               
001d36   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001d38   ffd9                                                                                                               
                                           {                                                                                F:\MCP\projects\CAN\Include\EEAccess.c
001d3a   98a1     BCF       0xa1,0x4,0x0   	PIR2bits.EEIF=0;                                                                F:\MCP\projects\CAN\Include\EEAccess.c
001d3c   0efd     MOVLW     0xfd           	EEADRH=(BYTE)(addr>>8);                                                         F:\MCP\projects\CAN\Include\EEAccess.c
001d3e   cfdb     MOVFF     0xfdb,0x14                                                                                      
001d40   f014                                                                                                               
001d42   0efe     MOVLW     0xfe                                                                                            
001d44   cfdb     MOVFF     0xfdb,0x15                                                                                      
001d46   f015                                                                                                               
001d48   c015     MOVFF     0x15,0x14                                                                                       
001d4a   f014                                                                                                               
001d4c   6a15     CLRF      0x15,0x0                                                                                        
001d4e   5014     MOVF      0x14,0x0,0x0                                                                                    
001d50   6eaa     MOVWF     0xaa,0x0                                                                                        
001d52   0eff     MOVLW     0xff           	EEADR=(BYTE)(addr & 0xFF);                                                      F:\MCP\projects\CAN\Include\EEAccess.c
001d54   6ee7     MOVWF     0xe7,0x0                                                                                        
001d56   0efd     MOVLW     0xfd                                                                                            
001d58   cfdb     MOVFF     0xfdb,0x14                                                                                      
001d5a   f014                                                                                                               
001d5c   0efe     MOVLW     0xfe                                                                                            
001d5e   cfdb     MOVFF     0xfdb,0x15                                                                                      
001d60   f015                                                                                                               
001d62   50e7     MOVF      0xe7,0x0,0x0                                                                                    
001d64   1614     ANDWF     0x14,0x1,0x0                                                                                    
001d66   6a15     CLRF      0x15,0x0                                                                                        
001d68   5014     MOVF      0x14,0x0,0x0                                                                                    
001d6a   6ea9     MOVWF     0xa9,0x0                                                                                        
001d6c   0efc     MOVLW     0xfc           	EEDATA=data;                                                                    F:\MCP\projects\CAN\Include\EEAccess.c
001d6e   50db     MOVF      0xdb,0x0,0x0                                                                                    
001d70   6ea8     MOVWF     0xa8,0x0                                                                                        
001d72   9ea6     BCF       0xa6,0x7,0x0   	EECON1bits.EEPGD=0;                                                             F:\MCP\projects\CAN\Include\EEAccess.c
001d74   9ca6     BCF       0xa6,0x6,0x0   	EECON1bits.CFGS=0;                                                              F:\MCP\projects\CAN\Include\EEAccess.c
001d76   84a6     BSF       0xa6,0x2,0x0   	EECON1bits.WREN=1;                                                              F:\MCP\projects\CAN\Include\EEAccess.c
001d78   9ef2     BCF       0xf2,0x7,0x0   	INTCONbits.GIE=0;                                                               F:\MCP\projects\CAN\Include\EEAccess.c
001d7a   0e55     MOVLW     0x55           	EECON2=0x55;                                                                    F:\MCP\projects\CAN\Include\EEAccess.c
001d7c   6ea7     MOVWF     0xa7,0x0                                                                                        
001d7e   0eaa     MOVLW     0xaa           	EECON2=0xAA;                                                                    F:\MCP\projects\CAN\Include\EEAccess.c
001d80   6ea7     MOVWF     0xa7,0x0                                                                                        
001d82   82a6     BSF       0xa6,0x1,0x0   	EECON1bits.WR=1;                                                                F:\MCP\projects\CAN\Include\EEAccess.c
001d84   8ef2     BSF       0xf2,0x7,0x0   	INTCONbits.GIE=1;                                                               F:\MCP\projects\CAN\Include\EEAccess.c
001d86   a8a1     BTFSS     0xa1,0x4,0x0   	while(!PIR2bits.EEIF);                                                          F:\MCP\projects\CAN\Include\EEAccess.c
001d88   d7fe     BRA       0x1d86                                                                                          
001d8a   94a6     BCF       0xa6,0x2,0x0   	EECON1bits.WREN=0;                                                              F:\MCP\projects\CAN\Include\EEAccess.c
001d8c   52e5     MOVF      0xe5,0x1,0x0   }                                                                                F:\MCP\projects\CAN\Include\EEAccess.c
001d8e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
001d90   ffd9                                                                                                               
001d92   0012     RETURN    0x0                                                                                             
                                           /*********************************************************************           F:\MCP\projects\CAN\Include\adc.c
                                            *                                                                               F:\MCP\projects\CAN\Include\adc.c
                                            *   Functions for reading ADC                                                   F:\MCP\projects\CAN\Include\adc.c
                                            *                                                                               F:\MCP\projects\CAN\Include\adc.c
                                            *********************************************************************           F:\MCP\projects\CAN\Include\adc.c
                                            * FileName:        $HeadURL: http://svn.arune.se/svn/HomeAutomation/trunk/EmbeddedSoftware/PIC/Include/adc.c $ F:\MCP\projects\CAN\Include\adc.c
                                            * Last changed:	$LastChangedDate: 2006-11-20 21:31:03 +0100 (m√•, 20 nov 2006) $ F:\MCP\projects\CAN\Include\adc.c
                                            * By:				$LastChangedBy: johboh $                                               F:\MCP\projects\CAN\Include\adc.c
                                            * Revision:		$Revision: 139 $                                                   F:\MCP\projects\CAN\Include\adc.c
                                            ********************************************************************/           F:\MCP\projects\CAN\Include\adc.c
                                           #include <adc.h>                                                                 F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                           #ifdef USE_ADC                                                                   F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                           static unsigned long TEMP_VALUE;                                                 F:\MCP\projects\CAN\Include\adc.c
                                           static unsigned int TEMP_COUNT;                                                  F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                           BOOL TEMP_DONE = FALSE;                                                          F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                           /*                                                                               F:\MCP\projects\CAN\Include\adc.c
                                           *	Function: adcInit                                                              F:\MCP\projects\CAN\Include\adc.c
                                           *                                                                                F:\MCP\projects\CAN\Include\adc.c
                                           *	Input:	True or false to use external voltage reference or not. portCfg is portconfiguration. F:\MCP\projects\CAN\Include\adc.c
                                           *	Output: none.                                                                  F:\MCP\projects\CAN\Include\adc.c
                                           *	Pre-conditions: none                                                           F:\MCP\projects\CAN\Include\adc.c
                                           *	Affects: none.                                                                 F:\MCP\projects\CAN\Include\adc.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\Include\adc.c
                                           */                                                                               F:\MCP\projects\CAN\Include\adc.c
0016ee   cfd9     MOVFF     0xfd9,0xfe6    void adcInit(BOOL useExtRef,BYTE portCfg)                                        F:\MCP\projects\CAN\Include\adc.c
0016f0   ffe6                                                                                                               
0016f2   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0016f4   ffd9                                                                                                               
                                           {                                                                                F:\MCP\projects\CAN\Include\adc.c
                                           	// Setup ADC to use low interrupt prior and external ref or not.                F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
0016f6   0efd     MOVLW     0xfd           	ADCON1 = 0b00000000 | ((1 & useExtRef)<<4) | (0xF & portCfg);                   F:\MCP\projects\CAN\Include\adc.c
0016f8   50db     MOVF      0xdb,0x0,0x0                                                                                    
0016fa   0b0f     ANDLW     0xf                                                                                             
0016fc   6e14     MOVWF     0x14,0x0                                                                                        
0016fe   0efe     MOVLW     0xfe                                                                                            
001700   50db     MOVF      0xdb,0x0,0x0                                                                                    
001702   0b01     ANDLW     0x1                                                                                             
001704   0d10     MULLW     0x10                                                                                            
001706   50f3     MOVF      0xf3,0x0,0x0                                                                                    
001708   1014     IORWF     0x14,0x0,0x0                                                                                    
00170a   6ec1     MOVWF     0xc1,0x0                                                                                        
00170c   6ac2     CLRF      0xc2,0x0       	ADCON0 = 0b00000000;                                                            F:\MCP\projects\CAN\Include\adc.c
00170e   0eab     MOVLW     0xab           	ADCON2 = 0b10101011;                                                            F:\MCP\projects\CAN\Include\adc.c
001710   6ec0     MOVWF     0xc0,0x0                                                                                        
                                           	//useExtRef                                                                     F:\MCP\projects\CAN\Include\adc.c
001712   80c2     BSF       0xc2,0x0,0x0   	ADCON0bits.ADON = 1;                                                            F:\MCP\projects\CAN\Include\adc.c
001714   9c9e     BCF       0x9e,0x6,0x0   	PIR1bits.ADIF = 0;                                                              F:\MCP\projects\CAN\Include\adc.c
001716   8c9d     BSF       0x9d,0x6,0x0   	PIE1bits.ADIE = 1;                                                              F:\MCP\projects\CAN\Include\adc.c
001718   9c9f     BCF       0x9f,0x6,0x0   	IPR1bits.ADIP = 0; // Low priority                                              F:\MCP\projects\CAN\Include\adc.c
00171a   52e5     MOVF      0xe5,0x1,0x0   }                                                                                F:\MCP\projects\CAN\Include\adc.c
00171c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00171e   ffd9                                                                                                               
001720   0012     RETURN    0x0                                                                                             
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                           /*                                                                               F:\MCP\projects\CAN\Include\adc.c
                                           *	Function: adcISR                                                               F:\MCP\projects\CAN\Include\adc.c
                                           *                                                                                F:\MCP\projects\CAN\Include\adc.c
                                           *	Input:	ADC interrupt rotune. Need to be called from LOW ISR.                   F:\MCP\projects\CAN\Include\adc.c
                                           *	Output: none.                                                                  F:\MCP\projects\CAN\Include\adc.c
                                           *	Pre-conditions: none                                                           F:\MCP\projects\CAN\Include\adc.c
                                           *	Affects: none.                                                                 F:\MCP\projects\CAN\Include\adc.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\Include\adc.c
                                           */                                                                               F:\MCP\projects\CAN\Include\adc.c
                                           void adcISR(void)                                                                F:\MCP\projects\CAN\Include\adc.c
                                           {                                                                                F:\MCP\projects\CAN\Include\adc.c
001722   509d     MOVF      0x9d,0x0,0x0   	if (PIE1bits.ADIE && PIR1bits.ADIF)                                             F:\MCP\projects\CAN\Include\adc.c
001724   0b40     ANDLW     0x40                                                                                            
001726   e050     BZ        0x17c8                                                                                          
001728   509e     MOVF      0x9e,0x0,0x0                                                                                    
00172a   0b40     ANDLW     0x40                                                                                            
00172c   e04d     BZ        0x17c8                                                                                          
                                           	{                                                                               F:\MCP\projects\CAN\Include\adc.c
00172e   9c9e     BCF       0x9e,0x6,0x0   		PIR1bits.ADIF = 0;                                                             F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
001730   50c4     MOVF      0xc4,0x0,0x0   		TEMP_VALUE+=((int)ADRESH)<<8 | ADRESL;                                         F:\MCP\projects\CAN\Include\adc.c
001732   6e18     MOVWF     0x18,0x0                                                                                        
001734   c018     MOVFF     0x18,0x19                                                                                       
001736   f019                                                                                                               
001738   6a18     CLRF      0x18,0x0                                                                                        
00173a   50c3     MOVF      0xc3,0x0,0x0                                                                                    
00173c   0100     MOVLB     0x0                                                                                             
00173e   1018     IORWF     0x18,0x0,0x0                                                                                    
001740   6e14     MOVWF     0x14,0x0                                                                                        
001742   c019     MOVFF     0x19,0x15                                                                                       
001744   f015                                                                                                               
001746   6a16     CLRF      0x16,0x0                                                                                        
001748   6a17     CLRF      0x17,0x0                                                                                        
00174a   ae15     BTFSS     0x15,0x7,0x0                                                                                    
00174c   d002     BRA       0x1752                                                                                          
00174e   6816     SETF      0x16,0x0                                                                                        
001750   6817     SETF      0x17,0x0                                                                                        
001752   5014     MOVF      0x14,0x0,0x0                                                                                    
001754   0100     MOVLB     0x0                                                                                             
001756   2790     ADDWF     0x90,0x1,0x1                                                                                    
001758   5015     MOVF      0x15,0x0,0x0                                                                                    
00175a   2391     ADDWFC    0x91,0x1,0x1                                                                                    
00175c   5016     MOVF      0x16,0x0,0x0                                                                                    
00175e   2392     ADDWFC    0x92,0x1,0x1                                                                                    
001760   5017     MOVF      0x17,0x0,0x0                                                                                    
001762   2393     ADDWFC    0x93,0x1,0x1                                                                                    
001764   2b94     INCF      0x94,0x1,0x1   		TEMP_COUNT++;                                                                  F:\MCP\projects\CAN\Include\adc.c
001766   0e00     MOVLW     0x0                                                                                             
001768   2395     ADDWFC    0x95,0x1,0x1                                                                                    
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
00176a   0e32     MOVLW     0x32           		if (TEMP_COUNT>=TEMP_SAMPLES)                                                  F:\MCP\projects\CAN\Include\adc.c
00176c   5d94     SUBWF     0x94,0x0,0x1                                                                                    
00176e   0e00     MOVLW     0x0                                                                                             
001770   5995     SUBWFB    0x95,0x0,0x1                                                                                    
001772   e324     BNC       0x17bc                                                                                          
                                           		{                                                                              F:\MCP\projects\CAN\Include\adc.c
001774   c094     MOVFF     0x94,0x14      			TEMP_VALUE = TEMP_VALUE/TEMP_COUNT;                                           F:\MCP\projects\CAN\Include\adc.c
001776   f014                                                                                                               
001778   c095     MOVFF     0x95,0x15                                                                                       
00177a   f015                                                                                                               
00177c   6a16     CLRF      0x16,0x0                                                                                        
00177e   6a17     CLRF      0x17,0x0                                                                                        
001780   c090     MOVFF     0x90,0x6                                                                                        
001782   f006                                                                                                               
001784   c091     MOVFF     0x91,0x7                                                                                        
001786   f007                                                                                                               
001788   c092     MOVFF     0x92,0x8                                                                                        
00178a   f008                                                                                                               
00178c   c093     MOVFF     0x93,0x9                                                                                        
00178e   f009                                                                                                               
001790   c014     MOVFF     0x14,0xb                                                                                        
001792   f00b                                                                                                               
001794   c015     MOVFF     0x15,0xc                                                                                        
001796   f00c                                                                                                               
001798   c016     MOVFF     0x16,0xd                                                                                        
00179a   f00d                                                                                                               
00179c   c017     MOVFF     0x17,0xe                                                                                        
00179e   f00e                                                                                                               
0017a0   eca4     CALL      0x1f48,0x0                                                                                      
0017a2   f00f                                                                                                               
0017a4   c006     MOVFF     0x6,0x90                                                                                        
0017a6   f090                                                                                                               
0017a8   c007     MOVFF     0x7,0x91                                                                                        
0017aa   f091                                                                                                               
0017ac   c008     MOVFF     0x8,0x92                                                                                        
0017ae   f092                                                                                                               
0017b0   c009     MOVFF     0x9,0x93                                                                                        
0017b2   f093                                                                                                               
0017b4   0100     MOVLB     0x0            			TEMP_DONE = TRUE;                                                             F:\MCP\projects\CAN\Include\adc.c
0017b6   0e01     MOVLW     0x1                                                                                             
0017b8   6f9d     MOVWF     0x9d,0x1                                                                                        
                                           		}                                                                              F:\MCP\projects\CAN\Include\adc.c
0017ba   d006     BRA       0x17c8         		else                                                                           F:\MCP\projects\CAN\Include\adc.c
                                           		{                                                                              F:\MCP\projects\CAN\Include\adc.c
0017bc   0e64     MOVLW     0x64           			Delay10TCYx(100);                                                             F:\MCP\projects\CAN\Include\adc.c
0017be   6ee6     MOVWF     0xe6,0x0                                                                                        
0017c0   ec0c     CALL      0x2018,0x0                                                                                      
0017c2   f010                                                                                                               
0017c4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0017c6   82c2     BSF       0xc2,0x1,0x0   			ADCON0bits.GO = 1;                                                            F:\MCP\projects\CAN\Include\adc.c
                                           		}                                                                              F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                           	}                                                                               F:\MCP\projects\CAN\Include\adc.c
0017c8   0012     RETURN    0x0            }                                                                                F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                           /*                                                                               F:\MCP\projects\CAN\Include\adc.c
                                           *	Function: adcConvert                                                           F:\MCP\projects\CAN\Include\adc.c
                                           *                                                                                F:\MCP\projects\CAN\Include\adc.c
                                           *	Input:	Channel to start convert. Between 0 and 15                              F:\MCP\projects\CAN\Include\adc.c
                                           *	Output: none.                                                                  F:\MCP\projects\CAN\Include\adc.c
                                           *	Pre-conditions: none                                                           F:\MCP\projects\CAN\Include\adc.c
                                           *	Affects: none.                                                                 F:\MCP\projects\CAN\Include\adc.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\Include\adc.c
                                           */                                                                               F:\MCP\projects\CAN\Include\adc.c
0017ca   cfd9     MOVFF     0xfd9,0xfe6    BOOL adcConvert(BYTE channel)                                                    F:\MCP\projects\CAN\Include\adc.c
0017cc   ffe6                                                                                                               
0017ce   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0017d0   ffd9                                                                                                               
                                           {                                                                                F:\MCP\projects\CAN\Include\adc.c
0017d2   0efe     MOVLW     0xfe           	if (channel>15) return FALSE;                                                   F:\MCP\projects\CAN\Include\adc.c
0017d4   50db     MOVF      0xdb,0x0,0x0                                                                                    
0017d6   080f     SUBLW     0xf                                                                                             
0017d8   e202     BC        0x17de                                                                                          
0017da   0e00     MOVLW     0x0                                                                                             
0017dc   d015     BRA       0x1808                                                                                          
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
0017de   0100     MOVLB     0x0            	TEMP_VALUE = 0;                                                                 F:\MCP\projects\CAN\Include\adc.c
0017e0   6b90     CLRF      0x90,0x1                                                                                        
0017e2   6b91     CLRF      0x91,0x1                                                                                        
0017e4   6b92     CLRF      0x92,0x1                                                                                        
0017e6   6b93     CLRF      0x93,0x1                                                                                        
0017e8   6b94     CLRF      0x94,0x1       	TEMP_COUNT = 0;                                                                 F:\MCP\projects\CAN\Include\adc.c
0017ea   6b95     CLRF      0x95,0x1                                                                                        
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
0017ec   0ec3     MOVLW     0xc3           	ADCON0 = (channel << 2)  | (ADCON0 & 0b11000011);                               F:\MCP\projects\CAN\Include\adc.c
0017ee   14c2     ANDWF     0xc2,0x0,0x0                                                                                    
0017f0   6e14     MOVWF     0x14,0x0                                                                                        
0017f2   0efe     MOVLW     0xfe                                                                                            
0017f4   50db     MOVF      0xdb,0x0,0x0                                                                                    
0017f6   0d04     MULLW     0x4                                                                                             
0017f8   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0017fa   1014     IORWF     0x14,0x0,0x0                                                                                    
0017fc   6ec2     MOVWF     0xc2,0x0                                                                                        
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
0017fe   0100     MOVLB     0x0            	TEMP_DONE = FALSE;                                                              F:\MCP\projects\CAN\Include\adc.c
001800   6b9d     CLRF      0x9d,0x1                                                                                        
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
001802   82c2     BSF       0xc2,0x1,0x0   	ADCON0bits.GO = 1;                                                              F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
001804   0e01     MOVLW     0x1            	return TRUE;                                                                    F:\MCP\projects\CAN\Include\adc.c
001806   d000     BRA       0x1808                                                                                          
001808   52e5     MOVF      0xe5,0x1,0x0   }                                                                                F:\MCP\projects\CAN\Include\adc.c
00180a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00180c   ffd9                                                                                                               
00180e   0012     RETURN    0x0                                                                                             
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                           /*                                                                               F:\MCP\projects\CAN\Include\adc.c
                                           *	Function: adcRead                                                              F:\MCP\projects\CAN\Include\adc.c
                                           *                                                                                F:\MCP\projects\CAN\Include\adc.c
                                           *	Input:	none.                                                                   F:\MCP\projects\CAN\Include\adc.c
                                           *	Output: Raw read data.                                                         F:\MCP\projects\CAN\Include\adc.c
                                           *	Pre-conditions: none                                                           F:\MCP\projects\CAN\Include\adc.c
                                           *	Affects: none.                                                                 F:\MCP\projects\CAN\Include\adc.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\Include\adc.c
                                           */                                                                               F:\MCP\projects\CAN\Include\adc.c
                                           int adcRead(void)                                                                F:\MCP\projects\CAN\Include\adc.c
                                           {                                                                                F:\MCP\projects\CAN\Include\adc.c
001810   0100     MOVLB     0x0            	TEMP_DONE=FALSE;                                                                F:\MCP\projects\CAN\Include\adc.c
001812   6b9d     CLRF      0x9d,0x1                                                                                        
001814   c090     MOVFF     0x90,0xff3     	return TEMP_VALUE;                                                              F:\MCP\projects\CAN\Include\adc.c
001816   fff3                                                                                                               
001818   c091     MOVFF     0x91,0xff4                                                                                      
00181a   fff4                                                                                                               
00181c   d000     BRA       0x181e                                                                                          
00181e   0012     RETURN    0x0            }                                                                                F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                           /*                                                                               F:\MCP\projects\CAN\Include\adc.c
                                           *	Function: temperatureRead                                                      F:\MCP\projects\CAN\Include\adc.c
                                           *                                                                                F:\MCP\projects\CAN\Include\adc.c
                                           *	Input:	none.                                                                   F:\MCP\projects\CAN\Include\adc.c
                                           *	Output: XX.Y C, where tenth is XX and decimal is Y                             F:\MCP\projects\CAN\Include\adc.c
                                           *	Pre-conditions: none                                                           F:\MCP\projects\CAN\Include\adc.c
                                           *	Affects: none.                                                                 F:\MCP\projects\CAN\Include\adc.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\Include\adc.c
                                           */                                                                               F:\MCP\projects\CAN\Include\adc.c
001820   cfd9     MOVFF     0xfd9,0xfe6    void temperatureRead(signed char *tenth, BYTE *decimal)                          F:\MCP\projects\CAN\Include\adc.c
001822   ffe6                                                                                                               
001824   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001826   ffd9                                                                                                               
001828   0e08     MOVLW     0x8                                                                                             
00182a   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                F:\MCP\projects\CAN\Include\adc.c
                                           	// assuming 2.5V ref and TC47                                                   F:\MCP\projects\CAN\Include\adc.c
00182c   6ade     CLRF      0xde,0x0       	signed int i = 0, v11,v01,tfloat;                                               F:\MCP\projects\CAN\Include\adc.c
00182e   6add     CLRF      0xdd,0x0                                                                                        
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
001830   c090     MOVFF     0x90,0x18      	tfloat =((TEMP_VALUE * 39)>>4) - 499;                                           F:\MCP\projects\CAN\Include\adc.c
001832   f018                                                                                                               
001834   c091     MOVFF     0x91,0x19                                                                                       
001836   f019                                                                                                               
001838   c092     MOVFF     0x92,0x1a                                                                                       
00183a   f01a                                                                                                               
00183c   c093     MOVFF     0x93,0x1b                                                                                       
00183e   f01b                                                                                                               
001840   0e27     MOVLW     0x27                                                                                            
001842   6e0b     MOVWF     0xb,0x0                                                                                         
001844   6a0c     CLRF      0xc,0x0                                                                                         
001846   6a0d     CLRF      0xd,0x0                                                                                         
001848   6a0e     CLRF      0xe,0x0                                                                                         
00184a   c018     MOVFF     0x18,0x6                                                                                        
00184c   f006                                                                                                               
00184e   c019     MOVFF     0x19,0x7                                                                                        
001850   f007                                                                                                               
001852   c01a     MOVFF     0x1a,0x8                                                                                        
001854   f008                                                                                                               
001856   c01b     MOVFF     0x1b,0x9                                                                                        
001858   f009                                                                                                               
00185a   ec6c     CALL      0x1ed8,0x0                                                                                      
00185c   f00f                                                                                                               
00185e   c002     MOVFF     0x2,0x18                                                                                        
001860   f018                                                                                                               
001862   c003     MOVFF     0x3,0x19                                                                                        
001864   f019                                                                                                               
001866   c004     MOVFF     0x4,0x1a                                                                                        
001868   f01a                                                                                                               
00186a   c005     MOVFF     0x5,0x1b                                                                                        
00186c   f01b                                                                                                               
00186e   0e04     MOVLW     0x4                                                                                             
001870   90d8     BCF       0xd8,0x0,0x0                                                                                    
001872   321b     RRCF      0x1b,0x1,0x0                                                                                    
001874   321a     RRCF      0x1a,0x1,0x0                                                                                    
001876   3219     RRCF      0x19,0x1,0x0                                                                                    
001878   3218     RRCF      0x18,0x1,0x0                                                                                    
00187a   06e8     DECF      0xe8,0x1,0x0                                                                                    
00187c   e1f9     BNZ       0x1870                                                                                          
00187e   c018     MOVFF     0x18,0x14                                                                                       
001880   f014                                                                                                               
001882   c019     MOVFF     0x19,0x15                                                                                       
001884   f015                                                                                                               
001886   c01a     MOVFF     0x1a,0x16                                                                                       
001888   f016                                                                                                               
00188a   c01b     MOVFF     0x1b,0x17                                                                                       
00188c   f017                                                                                                               
00188e   0ef3     MOVLW     0xf3                                                                                            
001890   5e14     SUBWF     0x14,0x1,0x0                                                                                    
001892   0e01     MOVLW     0x1                                                                                             
001894   5a15     SUBWFB    0x15,0x1,0x0                                                                                    
001896   0e00     MOVLW     0x0                                                                                             
001898   5a16     SUBWFB    0x16,0x1,0x0                                                                                    
00189a   5a17     SUBWFB    0x17,0x1,0x0                                                                                    
00189c   0e06     MOVLW     0x6                                                                                             
00189e   c014     MOVFF     0x14,0xfdb                                                                                      
0018a0   ffdb                                                                                                               
0018a2   0e07     MOVLW     0x7                                                                                             
0018a4   c015     MOVFF     0x15,0xfdb                                                                                      
0018a6   ffdb                                                                                                               
                                           	                                                                                F:\MCP\projects\CAN\Include\adc.c
0018a8   0e0a     MOVLW     0xa            	v11 = tfloat/10;                                                                F:\MCP\projects\CAN\Include\adc.c
0018aa   6e14     MOVWF     0x14,0x0                                                                                        
0018ac   6a15     CLRF      0x15,0x0                                                                                        
0018ae   0e06     MOVLW     0x6                                                                                             
0018b0   cfdb     MOVFF     0xfdb,0x8                                                                                       
0018b2   f008                                                                                                               
0018b4   0e07     MOVLW     0x7                                                                                             
0018b6   cfdb     MOVFF     0xfdb,0x9                                                                                       
0018b8   f009                                                                                                               
0018ba   c014     MOVFF     0x14,0xd                                                                                        
0018bc   f00d                                                                                                               
0018be   c015     MOVFF     0x15,0xe                                                                                        
0018c0   f00e                                                                                                               
0018c2   ecca     CALL      0x1d94,0x0                                                                                      
0018c4   f00e                                                                                                               
0018c6   0e02     MOVLW     0x2                                                                                             
0018c8   c008     MOVFF     0x8,0xfdb                                                                                       
0018ca   ffdb                                                                                                               
0018cc   0e03     MOVLW     0x3                                                                                             
0018ce   c009     MOVFF     0x9,0xfdb                                                                                       
0018d0   ffdb                                                                                                               
0018d2   0e06     MOVLW     0x6            	v01 = tfloat-v11*10;                                                            F:\MCP\projects\CAN\Include\adc.c
0018d4   cfdb     MOVFF     0xfdb,0x16                                                                                      
0018d6   f016                                                                                                               
0018d8   0e07     MOVLW     0x7                                                                                             
0018da   cfdb     MOVFF     0xfdb,0x17                                                                                      
0018dc   f017                                                                                                               
0018de   0e0a     MOVLW     0xa                                                                                             
0018e0   6e08     MOVWF     0x8,0x0                                                                                         
0018e2   6a09     CLRF      0x9,0x0                                                                                         
0018e4   0e02     MOVLW     0x2                                                                                             
0018e6   cfdb     MOVFF     0xfdb,0xd                                                                                       
0018e8   f00d                                                                                                               
0018ea   0e03     MOVLW     0x3                                                                                             
0018ec   cfdb     MOVFF     0xfdb,0xe                                                                                       
0018ee   f00e                                                                                                               
0018f0   ecf0     CALL      0x1de0,0x0                                                                                      
0018f2   f00e                                                                                                               
0018f4   5006     MOVF      0x6,0x0,0x0                                                                                     
0018f6   5c16     SUBWF     0x16,0x0,0x0                                                                                    
0018f8   6e14     MOVWF     0x14,0x0                                                                                        
0018fa   5007     MOVF      0x7,0x0,0x0                                                                                     
0018fc   5817     SUBWFB    0x17,0x0,0x0                                                                                    
0018fe   6e15     MOVWF     0x15,0x0                                                                                        
001900   0e04     MOVLW     0x4                                                                                             
001902   c014     MOVFF     0x14,0xfdb                                                                                      
001904   ffdb                                                                                                               
001906   0e05     MOVLW     0x5                                                                                             
001908   c015     MOVFF     0x15,0xfdb                                                                                      
00190a   ffdb                                                                                                               
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
00190c   0e04     MOVLW     0x4            	     if (v01>=0 && v01<=2) v01 = 0;                                             F:\MCP\projects\CAN\Include\adc.c
00190e   cfdb     MOVFF     0xfdb,0x14                                                                                      
001910   f014                                                                                                               
001912   0e05     MOVLW     0x5                                                                                             
001914   cfdb     MOVFF     0xfdb,0x15                                                                                      
001916   f015                                                                                                               
001918   0100     MOVLB     0x0                                                                                             
00191a   0e80     MOVLW     0x80                                                                                            
00191c   1415     ANDWF     0x15,0x0,0x0                                                                                    
00191e   e112     BNZ       0x1944                                                                                          
001920   0e04     MOVLW     0x4                                                                                             
001922   cfdb     MOVFF     0xfdb,0x16                                                                                      
001924   f016                                                                                                               
001926   0e05     MOVLW     0x5                                                                                             
001928   cfdb     MOVFF     0xfdb,0x17                                                                                      
00192a   f017                                                                                                               
00192c   3417     RLCF      0x17,0x0,0x0                                                                                    
00192e   e204     BC        0x1938                                                                                          
001930   5016     MOVF      0x16,0x0,0x0                                                                                    
001932   0802     SUBLW     0x2                                                                                             
001934   0e00     MOVLW     0x0                                                                                             
001936   5417     SUBFWB    0x17,0x0,0x0                                                                                    
001938   e305     BNC       0x1944                                                                                          
00193a   0e04     MOVLW     0x4                                                                                             
00193c   6adb     CLRF      0xdb,0x0                                                                                        
00193e   0e05     MOVLW     0x5                                                                                             
001940   6adb     CLRF      0xdb,0x0                                                                                        
001942   d02c     BRA       0x199c         	else if (v01>=3 && v01<=7) v01 = 5;                                             F:\MCP\projects\CAN\Include\adc.c
001944   0e04     MOVLW     0x4                                                                                             
001946   cfdb     MOVFF     0xfdb,0x14                                                                                      
001948   f014                                                                                                               
00194a   0e05     MOVLW     0x5                                                                                             
00194c   cfdb     MOVFF     0xfdb,0x15                                                                                      
00194e   f015                                                                                                               
001950   90d8     BCF       0xd8,0x0,0x0                                                                                    
001952   5015     MOVF      0x15,0x0,0x0                                                                                    
001954   e604     BN        0x195e                                                                                          
001956   0e03     MOVLW     0x3                                                                                             
001958   5c14     SUBWF     0x14,0x0,0x0                                                                                    
00195a   0e00     MOVLW     0x0                                                                                             
00195c   5815     SUBWFB    0x15,0x0,0x0                                                                                    
00195e   e315     BNC       0x198a                                                                                          
001960   0e04     MOVLW     0x4                                                                                             
001962   cfdb     MOVFF     0xfdb,0x16                                                                                      
001964   f016                                                                                                               
001966   0e05     MOVLW     0x5                                                                                             
001968   cfdb     MOVFF     0xfdb,0x17                                                                                      
00196a   f017                                                                                                               
00196c   3417     RLCF      0x17,0x0,0x0                                                                                    
00196e   e204     BC        0x1978                                                                                          
001970   5016     MOVF      0x16,0x0,0x0                                                                                    
001972   0807     SUBLW     0x7                                                                                             
001974   0e00     MOVLW     0x0                                                                                             
001976   5417     SUBFWB    0x17,0x0,0x0                                                                                    
001978   e308     BNC       0x198a                                                                                          
00197a   0e05     MOVLW     0x5                                                                                             
00197c   6ef3     MOVWF     0xf3,0x0                                                                                        
00197e   0e04     MOVLW     0x4                                                                                             
001980   cff3     MOVFF     0xff3,0xfdb                                                                                     
001982   ffdb                                                                                                               
001984   0e05     MOVLW     0x5                                                                                             
001986   6adb     CLRF      0xdb,0x0                                                                                        
001988   d009     BRA       0x199c         	else  { v01 = 0; v11++;}                                                        F:\MCP\projects\CAN\Include\adc.c
00198a   0e04     MOVLW     0x4                                                                                             
00198c   6adb     CLRF      0xdb,0x0                                                                                        
00198e   0e05     MOVLW     0x5                                                                                             
001990   6adb     CLRF      0xdb,0x0                                                                                        
001992   0e02     MOVLW     0x2                                                                                             
001994   2adb     INCF      0xdb,0x1,0x0                                                                                    
001996   0e03     MOVLW     0x3                                                                                             
001998   e301     BNC       0x199c                                                                                          
00199a   2adb     INCF      0xdb,0x1,0x0                                                                                    
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
00199c   0e02     MOVLW     0x2            	tenth = (signed char *)v11;                                                     F:\MCP\projects\CAN\Include\adc.c
00199e   cfdb     MOVFF     0xfdb,0x8                                                                                       
0019a0   f008                                                                                                               
0019a2   0e03     MOVLW     0x3                                                                                             
0019a4   cfdb     MOVFF     0xfdb,0x9                                                                                       
0019a6   f009                                                                                                               
0019a8   0efd     MOVLW     0xfd                                                                                            
0019aa   c008     MOVFF     0x8,0xfdb                                                                                       
0019ac   ffdb                                                                                                               
0019ae   0efe     MOVLW     0xfe                                                                                            
0019b0   c009     MOVFF     0x9,0xfdb                                                                                       
0019b2   ffdb                                                                                                               
0019b4   0e04     MOVLW     0x4            	decimal = (BYTE *)v01;                                                          F:\MCP\projects\CAN\Include\adc.c
0019b6   cfdb     MOVFF     0xfdb,0x8                                                                                       
0019b8   f008                                                                                                               
0019ba   0e05     MOVLW     0x5                                                                                             
0019bc   cfdb     MOVFF     0xfdb,0x9                                                                                       
0019be   f009                                                                                                               
0019c0   0efb     MOVLW     0xfb                                                                                            
0019c2   c008     MOVFF     0x8,0xfdb                                                                                       
0019c4   ffdb                                                                                                               
0019c6   0efc     MOVLW     0xfc                                                                                            
0019c8   c009     MOVFF     0x9,0xfdb                                                                                       
0019ca   ffdb                                                                                                               
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
0019cc   0100     MOVLB     0x0            		TEMP_DONE=FALSE;                                                               F:\MCP\projects\CAN\Include\adc.c
0019ce   6b9d     CLRF      0x9d,0x1                                                                                        
0019d0   0e08     MOVLW     0x8            }                                                                                F:\MCP\projects\CAN\Include\adc.c
0019d2   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
0019d4   e202     BC        0x19da                                                                                          
0019d6   6ae1     CLRF      0xe1,0x0                                                                                        
0019d8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019da   6ee1     MOVWF     0xe1,0x0                                                                                        
0019dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019de   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0019e0   ffd9                                                                                                               
0019e2   0012     RETURN    0x0                                                                                             
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                           /*                                                                               F:\MCP\projects\CAN\Include\adc.c
                                           *	Function: adcDone                                                              F:\MCP\projects\CAN\Include\adc.c
                                           *                                                                                F:\MCP\projects\CAN\Include\adc.c
                                           *	Input:	none.                                                                   F:\MCP\projects\CAN\Include\adc.c
                                           *	Output: If adc convertion is done or not.                                      F:\MCP\projects\CAN\Include\adc.c
                                           *	Pre-conditions: none                                                           F:\MCP\projects\CAN\Include\adc.c
                                           *	Affects: none.                                                                 F:\MCP\projects\CAN\Include\adc.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\Include\adc.c
                                           */                                                                               F:\MCP\projects\CAN\Include\adc.c
                                           BOOL adcDone(void)                                                               F:\MCP\projects\CAN\Include\adc.c
                                           {                                                                                F:\MCP\projects\CAN\Include\adc.c
0019e4   0100     MOVLB     0x0            	return TEMP_DONE;                                                               F:\MCP\projects\CAN\Include\adc.c
0019e6   519d     MOVF      0x9d,0x0,0x1                                                                                    
0019e8   d000     BRA       0x19ea                                                                                          
0019ea   0012     RETURN    0x0            }                                                                                F:\MCP\projects\CAN\Include\adc.c
                                                                                                                            F:\MCP\projects\CAN\Include\adc.c
                                           #endif                                                                           F:\MCP\projects\CAN\Include\adc.c
                                           /*********************************************************************           F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                            *                                                                               F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                            *   Functions for controlling blinds                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                            *                                                                               F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                            *********************************************************************           F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                            * FileName:        $HeadURL: http://svn.arune.se/svn/HomeAutomation/trunk/EmbeddedSoftware/PIC/canTemp/Source/blinds.c $ F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                            * Last changed:	$LastChangedDate: 2007-01-30 12:53:25 +0100 (ti, 30 jan 2007) $ F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                            * By:				$LastChangedBy: johboh $                                               F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                            * Revision:		$Revision: 276 $                                                   F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                            ********************************************************************/           F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           #include <blinds.h>                                                              F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           #ifdef USE_BLINDS                                                                F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           static unsigned int timerVal = 50536;                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           /*                                                                               F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Function: blindsInit                                                           F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *                                                                                F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Input:	none.                                                                   F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Output: none.                                                                  F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Pre-conditions: none                                                           F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Affects: none.                                                                 F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           */                                                                               F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           void blindsInit()                                                                F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           {                                                                                F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	// setup timer one on 0.5ms.                                                    F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	// 16 bit write, system clock, prescale 2 bit, oscillator off,                  F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	T1CON = 0b11000001;                                                             F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	TMR1H=((timerVal&0xFF00)>>8);                                                   F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	TMR1L=(timerVal&0xFF);                                                          F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	PIR1bits.TMR1IF = 0;                                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	PIE1bits.TMR1IE = 1;                                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	IPR1bits.TMR1IP = 1; // high prior?                                             F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           }                                                                                F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           /*                                                                               F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Function: blindsTurn                                                           F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *                                                                                F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Input:	Angle to turn to.                                                       F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Output: none.                                                                  F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Pre-conditions: none                                                           F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Affects: none.                                                                 F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           */                                                                               F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           void blindsTurn(signed int angle)                                                F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           {                                                                                F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	// 65536-TIME/0,0000001                                                         F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	// -90 0.5 ms = 60536 (5000)                                                    F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	// 0   1.5 ms = 50536 (15000)                                                   F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	// 90  2.5 ms = 40536 (25000)                                                   F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	if (angle<-90) timerVal=60536;                                                  F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	else if (angle>90) timerVal=40536;                                              F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	else                                                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	{                                                                               F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           		timerVal=60536-((90+angle)*111.111);                                           F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	}                                                                               F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           }                                                                                F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           /*                                                                               F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Function: blindsISR                                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *                                                                                F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Input:	none.                                                                   F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Output: none.                                                                  F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Pre-conditions: none                                                           F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Affects: none.                                                                 F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           *	Depends: none.                                                                 F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           */                                                                               F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           void blindsISR(void)                                                             F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           {                                                                                F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	if (PIR1bits.TMR1IF == 1 && PIE1bits.TMR1IE == 1)                               F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	{                                                                               F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           		TMR1H=((timerVal&0xFF00)>>8);                                                  F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           		TMR1L=(timerVal&0xFF);                                                         F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           		BLINDS0_IO=~BLINDS0_IO;                                                        F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           		PIR1bits.TMR1IF = 0;                                                           F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           	}                                                                               F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           }                                                                                F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                                                                                                            F:\MCP\projects\CAN\canTemp\Source\blinds.c
                                           #endif                                                                           F:\MCP\projects\CAN\canTemp\Source\blinds.c
